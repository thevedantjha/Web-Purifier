/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/bad_words.js":
/*!**************************!*\
  !*** ./src/bad_words.js ***!
  \**************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BAD_WORDS: () => (/* binding */ BAD_WORDS)
/* harmony export */ });
const BAD_WORDS = ["abbo", "abo", "abortion", "abuse", "addict", "addicts", "adult", "africa", "african", "alla", "allah", "alligatorbait", "amateur", "american", "anal", "analannie", "analsex", "angie", "angry", "anus", "arab", "arabs", "areola", "argie", "aroused", "arse", "arsehole", "asian", "ass", "assassin", "assassinate", "assassination", "assault", "assbagger", "assblaster", "assclown", "asscowboy", "asses", "assfuck", "assfucker", "asshat", "asshole", "assholes", "asshore", "assjockey", "asskiss", "asskisser", "assklown", "asslick", "asslicker", "asslover", "assman", "assmonkey", "assmunch", "assmuncher", "asspacker", "asspirate", "asspuppies", "assranger", "asswhore", "asswipe", "athletesfoot", "attack", "australian", "babe", "babies", "backdoor", "backdoorman", "backseat", "badfuck", "balllicker", "balls", "ballsack", "banging", "baptist", "barelylegal", "barf", "barface", "barfface", "bast", "bastard", "bazongas", "bazooms", "beaner", "beast", "beastality", "beastial", "beastiality", "beatoff", "beat-off", "beatyourmeat", "beaver", "bestial", "bestiality", "bi", "biatch", "bible", "bicurious", "bigass", "bigbastard", "bigbutt", "bigger", "bisexual", "bi-sexual", "bitch", "bitchass", "bitcher", "bitches", "bitchez", "bitchin", "bitching", "bitchslap", "bitchy", "biteme", "black", "blackman", "blackout", "blacks", "blind", "blow", "blowjob", "boang", "bogan", "bohunk", "bollick", "bollock", "bomb", "bombers", "bombing", "bombs", "bomd", "bondage", "boner", "bong", "boob", "boobies", "boobs", "booby", "boody", "boom", "boong", "boonga", "boonie", "booty", "bootycall", "bountybar", "bra", "brea5t", "breast", "breastjob", "breastlover", "breastman", "brothel", "bugger", "buggered", "buggery", "bullcrap", "bulldike", "bulldyke", "bullshit", "bumblefuck", "bumfuck", "bunga", "bunghole", "buried", "burn", "butchbabes", "butchdike", "butchdyke", "butt", "buttbang", "butt-bang", "buttface", "buttfuck", "butt-fuck", "buttfucker", "butt-fucker", "buttfuckers", "butt-fuckers", "butthead", "buttman", "buttmunch", "buttmuncher", "buttpirate", "buttplug", "buttstain", "byatch", "cacker", "cameljockey", "cameltoe", "canadian", "cancer", "carpetmuncher", "carruth", "catholic", "catholics", "cemetery", "chav", "cherrypopper", "chickslick", "children's", "chin", "chinaman", "chinamen", "chinese", "chink", "chinky", "choad", "chode", "christ", "christian", "church", "cigarette", "cigs", "clamdigger", "clamdiver", "clit", "clitoris", "clogwog", "cocaine", "cock", "cockblock", "cockblocker", "cockcowboy", "cockfight", "cockhead", "cockknob", "cocklicker", "cocklover", "cocknob", "cockqueen", "cockrider", "cocksman", "cocksmith", "cocksmoker", "cocksucer", "cocksuck", "cocksucked", "cocksucker", "cocksucking", "cocktail", "cocktease", "cocky", "cohee", "coitus", "color", "colored", "coloured", "commie", "communist", "condom", "conservative", "conspiracy", "coolie", "cooly", "coon", "coondog", "copulate", "cornhole", "corruption", "cra5h", "crabs", "crack", "crackpipe", "crackwhore", "crack-whore", "crap", "crapola", "crapper", "crappy", "crash", "creamy", "crime", "crimes", "criminal", "criminals", "crotch", "crotchjockey", "crotchmonkey", "crotchrot", "cum", "cumbubble", "cumfest", "cumjockey", "cumm", "cummer", "cumming", "cumquat", "cumqueen", "cumshot", "cunilingus", "cunillingus", "cunn", "cunnilingus", "cunntt", "cunt", "cunteyed", "cuntfuck", "cuntfucker", "cuntlick", "cuntlicker", "cuntlicking", "cuntsucker", "cybersex", "cyberslimer", "dago", "dahmer", "dammit", "damn", "damnation", "damnit", "darkie", "darky", "datnigga", "dead", "deapthroat", "death", "deepthroat", "defecate", "dego", "demon", "deposit", "desire", "destroy", "deth", "devil", "devilworshipper", "dick", "dickbrain", "dickforbrains", "dickhead", "dickless", "dicklick", "dicklicker", "dickman", "dickwad", "dickweed", "diddle", "die", "died", "dies", "dike", "dildo", "dingleberry", "dink", "dipshit", "dipstick", "dirty", "disease", "diseases", "disturbed", "dive", "dix", "dixiedike", "dixiedyke", "doggiestyle", "doggystyle", "dong", "doodoo", "doo-doo", "doom", "dope", "dragqueen", "dragqween", "dripdick", "drug", "drunk", "drunken", "dumb", "dumbass", "dumbbitch", "dumbfuck", "dyefly", "dyke", "easyslut", "eatballs", "eatme", "eatpussy", "ecstacy", "ejaculate", "ejaculated", "ejaculating", "ejaculation", "enema", "enemy", "erect", "erection", "ero", "escort", "ethiopian", "ethnic", "european", "evl", "excrement", "execute", "executed", "execution", "executioner", "explosion", "facefucker", "faeces", "fag", "fagging", "faggot", "fagot", "failed", "failure", "fairies", "fairy", "faith", "fannyfucker", "fart", "farted", "farting", "farty", "fastfuck", "fat", "fatah", "fatass", "fatfuck", "fatfucker", "fatso", "fckcum", "fear", "feces", "felatio", "felch", "felcher", "felching", "fellatio", "feltch", "feltcher", "feltching", "fetish", "fight", "filipina", "filipino", "fingerfood", "fingerfuck", "fingerfucked", "fingerfucker", "fingerfuckers", "fingerfucking", "fire", "firing", "fister", "fistfuck", "fistfucked", "fistfucker", "fistfucking", "fisting", "flange", "flasher", "flatulence", "floo", "flydie", "flydye", "fok", "fondle", "footaction", "footfuck", "footfucker", "footlicker", "footstar", "fore", "foreskin", "forni", "fornicate", "foursome", "fourtwenty", "fraud", "freakfuck", "freakyfucker", "freefuck", "fu", "fubar", "fuc", "fucck", "fuck", "fucka", "fuckable", "fuckass", "fuckbag", "fuckbuddy", "fucked", "fuckedup", "fucker", "fuckers", "fuckface", "fuckfest", "fuckfreak", "fuckfriend", "fuckhead", "fuckher", "fuckin", "fuckina", "fucking", "fuckingbitch", "fuckinnuts", "fuckinright", "fuckit", "fuckknob", "fuckme", "fuckmehard", "fuckmonkey", "fuckoff", "fuckpig", "fucks", "fucktard", "fuckwhore", "fuckyou", "fudgepacker", "fugly", "fuk", "fuks", "funeral", "funfuck", "fungus", "fuuck", "gangbang", "gangbanged", "gangbanger", "gangsta", "gatorbait", "gay", "gaymuthafuckinwhore", "gaysex", "geez", "geezer", "geni", "genital", "german", "getiton", "gin", "ginzo", "gipp", "girls", "givehead", "glazeddonut", "gob", "god", "godammit", "goddamit", "goddammit", "goddamn", "goddamned", "goddamnes", "goddamnit", "goddamnmuthafucker", "goldenshower", "gonorrehea", "gonzagas", "gook", "gotohell", "goy", "goyim", "greaseball", "gringo", "groe", "gross", "grostulation", "gubba", "gummer", "gun", "gyp", "gypo", "gypp", "gyppie", "gyppo", "gyppy", "hamas", "handjob", "hapa", "harder", "hardon", "harem", "headfuck", "headlights", "hebe", "heeb", "hell", "henhouse", "heroin", "herpes", "heterosexual", "hijack", "hijacker", "hijacking", "hillbillies", "hindoo", "hiscock", "hitler", "hitlerism", "hitlerist", "hiv", "ho", "hobo", "hodgie", "hoes", "hole", "holestuffer", "homicide", "homo", "homobangers", "homosexual", "honger", "honk", "honkers", "honkey", "honky", "hook", "hooker", "hookers", "hooters", "hore", "hork", "horn", "horney", "horniest", "horny", "horseshit", "hosejob", "hoser", "hostage", "hotdamn", "hotpussy", "hottotrot", "hummer", "husky", "hussy", "hustler", "hymen", "hymie", "iblowu", "idiot", "idiotic", "ikey", "illegal", "incest", "insest", "intercourse", "interracial", "intheass", "inthebuff", "israel", "israeli", "israel's", "italiano", "itch", "jackass", "jackoff", "jackshit", "jacktheripper", "jade", "jap", "japanese", "japcrap", "jebus", "jeez", "jerkoff", "jesus", "jesuschrist", "jew", "jewish", "jiga", "jigaboo", "jigg", "jigga", "jiggabo", "jigger", "jiggy", "jihad", "jijjiboo", "jimfish", "jism", "jiz", "jizim", "jizjuice", "jizm", "jizz", "jizzim", "jizzum", "joint", "juggalo", "jugs", "junglebunny", "kaffer", "kaffir", "kaffre", "kafir", "kanake", "kid", "kigger", "kike", "kill", "killed", "killer", "killing", "kills", "kink", "kinky", "kissass", "kkk", "knife", "knockers", "kock", "kondum", "koon", "kotex", "krap", "krappy", "kraut", "kum", "kumbubble", "kumbullbe", "kummer", "kumming", "kumquat", "kums", "kunilingus", "kunnilingus", "kunt", "ky", "kyke", "lactate", "laid", "lapdance", "latin", "lesbain", "lesbayn", "lesbian", "lesbin", "lesbo", "lez", "lezbe", "lezbefriends", "lezbo", "lezz", "lezzo", "liberal", "libido", "licker", "lickme", "lies", "limey", "limpdick", "limy", "lingerie", "liquor", "livesex", "loadedgun", "lolita", "looser", "loser", "lotion", "lovebone", "lovegoo", "lovegun", "lovejuice", "lovemuscle", "lovepistol", "loverocket", "lowlife", "lsd", "lubejob", "lucifer", "luckycammeltoe", "lugan", "lynch", "macaca", "mad", "mafia", "magicwand", "mams", "manhater", "manpaste", "marijuana", "mastabate", "mastabater", "masterbate", "masterblaster", "mastrabator", "masturbate", "masturbating", "mattressprincess", "meatbeatter", "meatrack", "meth", "mexican", "mgger", "mggor", "mickeyfinn", "mideast", "milf", "minority", "mockey", "mockie", "mocky", "mofo", "moky", "moles", "molest", "molestation", "molester", "molestor", "moneyshot", "mooncricket", "mormon", "moron", "moslem", "mosshead", "mothafuck", "mothafucka", "mothafuckaz", "mothafucked", "mothafucker", "mothafuckin", "mothafucking", "mothafuckings", "motherfuck", "motherfucked", "motherfucker", "motherfuckin", "motherfucking", "motherfuckings", "motherlovebone", "muff", "muffdive", "muffdiver", "muffindiver", "mufflikcer", "mulatto", "muncher", "munt", "murder", "murderer", "muslim", "naked", "narcotic", "nasty", "nastybitch", "nastyho", "nastyslut", "nastywhore", "nazi", "necro", "negro", "negroes", "negroid", "negro's", "nig", "niger", "nigerian", "nigerians", "nigg", "nigga", "niggah", "niggaracci", "niggard", "niggarded", "niggarding", "niggardliness", "niggardliness's", "niggardly", "niggards", "niggard's", "niggaz", "nigger", "niggerhead", "niggerhole", "niggers", "nigger's", "niggle", "niggled", "niggles", "niggling", "nigglings", "niggor", "niggur", "niglet", "nignog", "nigr", "nigra", "nigre", "nip", "nipple", "nipplering", "nittit", "nlgger", "nlggor", "nofuckingway", "nook", "nookey", "nookie", "noonan", "nooner", "nude", "nudger", "nuke", "nutfucker", "nymph", "ontherag", "oral", "orga", "orgasim", "orgasm", "orgies", "orgy", "osama", "paki", "palesimian", "palestinian", "pansies", "pansy", "panti", "panties", "payo", "pearlnecklace", "peck", "pecker", "peckerwood", "pee", "peehole", "pee-pee", "peepshow", "peepshpw", "pendy", "penetration", "peni5", "penile", "penis", "penises", "penthouse", "period", "perv", "phonesex", "phuk", "phuked", "phuking", "phukked", "phukking", "phungky", "phuq", "pi55", "picaninny", "piccaninny", "pickaninny", "piker", "pikey", "piky", "pimp", "pimped", "pimper", "pimpjuic", "pimpjuice", "pimpsimp", "pindick", "piss", "pissed", "pisser", "pisses", "pisshead", "pissin", "pissing", "pissoff", "pistol", "pixie", "pixy", "playboy", "playgirl", "pocha", "pocho", "pocketpool", "pohm", "polack", "pom", "pommie", "pommy", "poo", "poon", "poontang", "poop", "pooper", "pooperscooper", "pooping", "poorwhitetrash", "popimp", "porchmonkey", "porn", "pornflick", "pornking", "porno", "pornography", "pornprincess", "pot", "poverty", "premature", "pric", "prick", "prickhead", "primetime", "propaganda", "pros", "prostitute", "protestant", "pu55i", "pu55y", "pube", "pubic", "pubiclice", "pud", "pudboy", "pudd", "puddboy", "puke", "puntang", "purinapricness", "puss", "pussie", "pussies", "pussy", "pussycat", "pussyeater", "pussyfucker", "pussylicker", "pussylips", "pussylover", "pussypounder", "pusy", "quashie", "queef", "queer", "quickie", "quim", "ra8s", "rabbi", "racial", "racist", "radical", "radicals", "raghead", "randy", "rape", "raped", "raper", "rapist", "rearend", "rearentry", "rectum", "redlight", "redneck", "reefer", "reestie", "refugee", "reject", "remains", "rentafuck", "republican", "rere", "retard", "retarded", "ribbed", "rigger", "rimjob", "rimming", "roach", "robber", "roundeye", "rump", "russki", "russkie", "sadis", "sadom", "samckdaddy", "sandm", "sandnigger", "satan", "scag", "scallywag", "scat", "schlong", "screw", "screwyou", "scrotum", "scum", "semen", "seppo", "servant", "sex", "sexed", "sexfarm", "sexhound", "sexhouse", "sexing", "sexkitten", "sexpot", "sexslave", "sextogo", "sextoy", "sextoys", "sexual", "sexually", "sexwhore", "sexy", "sexymoma", "sexy-slim", "shag", "shaggin", "shagging", "shat", "shav", "shawtypimp", "sheeney", "shhit", "shinola", "shit", "shitass", "shitcan", "shitdick", "shite", "shiteater", "shited", "shitface", "shitfaced", "shitfit", "shitforbrains", "shitfuck", "shitfucker", "shitfull", "shithapens", "shithappens", "shithead", "shithouse", "shiting", "shitlist", "shitola", "shitoutofluck", "shits", "shitstain", "shitted", "shitter", "shitting", "shitty", "shoot", "shooting", "shortfuck", "showtime", "sick", "sissy", "sixsixsix", "sixtynine", "sixtyniner", "skank", "skankbitch", "skankfuck", "skankwhore", "skanky", "skankybitch", "skankywhore", "skinflute", "skum", "skumbag", "slant", "slanteye", "slapper", "slaughter", "slav", "slave", "slavedriver", "sleezebag", "sleezeball", "slideitin", "slime", "slimeball", "slimebucket", "slopehead", "slopey", "slopy", "slut", "sluts", "slutt", "slutting", "slutty", "slutwear", "slutwhore", "smack", "smackthemonkey", "smut", "snatch", "snatchpatch", "snigger", "sniggered", "sniggering", "sniggers", "snigger's", "sniper", "snot", "snowback", "snownigger", "sob", "sodom", "sodomise", "sodomite", "sodomize", "sodomy", "sonofabitch", "sonofbitch", "sooty", "sos", "soviet", "spaghettibender", "spaghettinigger", "spank", "spankthemonkey", "sperm", "spermacide", "spermbag", "spermhearder", "spermherder", "spic", "spick", "spig", "spigotty", "spik", "spit", "spitter", "splittail", "spooge", "spreadeagle", "spunk", "spunky", "squaw", "stagg", "stiffy", "strapon", "stringer", "stripclub", "stroke", "stroking", "stupid", "stupidfuck", "stupidfucker", "suck", "suckdick", "sucker", "suckme", "suckmyass", "suckmydick", "suckmytit", "suckoff", "suicide", "swallow", "swallower", "swalow", "swastika", "sweetness", "syphilis", "taboo", "taff", "tampon", "tang", "tantra", "tarbaby", "tard", "teat", "terror", "terrorist", "teste", "testicle", "testicles", "thicklips", "thirdeye", "thirdleg", "threesome", "threeway", "timbernigger", "tinkle", "tit", "titbitnipply", "titfuck", "titfucker", "titfuckin", "titjob", "titlicker", "titlover", "tits", "tittie", "titties", "titty", "tnt", "toilet", "tongethruster", "tongue", "tonguethrust", "tonguetramp", "tortur", "torture", "tosser", "towelhead", "trailertrash", "tramp", "trannie", "tranny", "transexual", "transsexual", "transvestite", "triplex", "trisexual", "trojan", "trots", "tuckahoe", "tunneloflove", "turd", "turnon", "twat", "twink", "twinkie", "twobitwhore", "uck", "uk", "unfuckable", "upskirt", "uptheass", "upthebutt", "urinary", "urinate", "urine", "usama", "uterus", "vagina", "vaginal", "vatican", "vibr", "vibrater", "vibrator", "vietcong", "violence", "virgin", "virginbreaker", "vomit", "vulva", "wab", "wank", "wanker", "wanking", "waysted", "weapon", "weenie", "weewee", "welcher", "welfare", "wetb", "wetback", "wetspot", "whacker", "whash", "whigger", "whiskey", "whiskeydick", "whiskydick", "whit", "whitenigger", "whites", "whitetrash", "whitey", "whiz", "whop", "whore", "whorefucker", "whorehouse", "wigger", "willie", "williewanker", "willy", "wn", "wog", "women's", "wop", "wtf", "wuss", "wuzzie", "xtc", "xxx", "yankee", "yellowman", "zigabo", "zipperhead"];

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it needs to be isolated against other modules in the chunk.
(() => {
/*!************************!*\
  !*** ./src/content.js ***!
  \************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _bad_words_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bad_words.js */ "./src/bad_words.js");


const BAD_WORDS_SET = new Set(_bad_words_js__WEBPACK_IMPORTED_MODULE_0__.BAD_WORDS.map(w => w.toLowerCase()));
const rewriteCache = new Map();
const processedSentencesPerElement = new WeakMap();

let rewriter = null;
let lmSession = null;
let roundNumber = 1;
let isTextRoundInProgress = false;
let isImageRoundInProgress = false;
let isTheExtensionOn = false;
let globalRGB = null;

const TOXIC_SCORE_THRESHOLD = 0.8;

const BLURRED_CLASS = 'chrome-ext-blurred-image';
const CHECKED_CLASS = 'chrome-ext-checked-image';

const imageTextCache = new Map();

function splitIntoSentences(text) {
  const sentenceEndings = /([.!?])\s+/g;
  return text.split(sentenceEndings)
    .filter(Boolean)
    .map((sentence, index, array) => {
      if (index % 2 === 0) return sentence.trim() + (array[index + 1] || '').trim();
      return null;
    })
    .filter(Boolean);
}

function containsBadWord(text) {
  const words = text.toLowerCase().match(/\b\w+\b/g);
  if (!words) return false;
  return words.some(w => BAD_WORDS_SET.has(w));
}

function chunk(array, size) {
  return Array.from({ length: Math.ceil(array.length / size) }, (_, i) =>
    array.slice(i * size, i * size + size)
  );
}

function hexToRgb(hex) {
  const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return result ? {
    r: parseInt(result[1], 16),
    g: parseInt(result[2], 16),
    b: parseInt(result[3], 16)
  } : { r: 0, g: 255, b: 0 };
}

async function classifySentencesBatch(sentences) {
  return new Promise(resolve => {
    chrome.runtime.sendMessage({ action: "classifyBatch", sentences }, (response) => {
      if (chrome.runtime.lastError || !response) resolve([]);
      else resolve(response);
    });
  });
}

async function classifyDetectedText(text) {
  if (!text || text.trim() === '') return { decision: 'no-text' };

  const cacheKey = text.trim();
  if (imageTextCache.has(cacheKey)) {
    return imageTextCache.get(cacheKey);
  }

  return new Promise((resolve) => {
    chrome.runtime.sendMessage({ action: 'classify', text }, (response) => {
      if (chrome.runtime.lastError || !response) {
        const res = { decision: 'error' };
        imageTextCache.set(cacheKey, res);
        return resolve(res);
      }

      try {
        let top = null;
        if (Array.isArray(response) && response.length > 0) top = response[0];
        else if (response && response[0]) top = response[0];

        if (!top) {
          const res = { decision: 'safe' };
          imageTextCache.set(cacheKey, res);
          return resolve(res);
        }

        const label = (top.label || '').toLowerCase();
        const score = typeof top.score === 'number' ? top.score : parseFloat(top.score || 0);
        const isToxic = label.includes('toxic') && score >= TOXIC_SCORE_THRESHOLD;

        const res = {
          decision: isToxic ? 'toxic' : 'safe',
          label,
          score
        };

        imageTextCache.set(cacheKey, res);
        resolve(res);
      } catch (err) {
        const res = { decision: 'error' };
        imageTextCache.set(cacheKey, res);
        resolve(res);
      }
    });
  });
}

async function initializeRewriter() {
  if (rewriter) return rewriter;

  if (!('Rewriter' in self)) {
    console.error('âŒ Rewriter API not supported in this environment.');
    return null;
  }

  try {
    const availability = await Rewriter.availability();
    if (availability === 'unavailable') {
      console.error('âŒ Rewriter API unavailable.');
      return null;
    }

    console.log('Initializing Rewriter...');

    rewriter = await Rewriter.create({
      sharedContext: 'ONLY rewriting toxic text to be nice/harmless. Only output rewrite, no intro.',
      tone: 'more-formal',
      format: 'plain-text',
      length: 'shorter',
      monitor(m) {
        m.addEventListener("downloadprogress", e => {
          try {
            console.log(`Rewriter download progress: ${Math.round((e.loaded / e.total) * 100)}%`);
          } catch (err) {
            console.log('Rewriter download progress event', e);
          }
        });
      }
    });

    console.log('Rewriter initialized.');
    return rewriter;
  } catch (err) {
    console.error("âŒ Rewriter initialization failed:", err);
    return null;
  }
}

async function rewriteSentence(sentence) {
  sentence = sentence.trim();
  if (rewriteCache.has(sentence)) return rewriteCache.get(sentence);

  try {
    const rw = await initializeRewriter();
    if (!rw) {
      console.error('âŒ Rewriter is not initialized!');
      rewriteCache.set(sentence, sentence);
      return sentence;
    }

    const rewritten = await rw.rewrite(sentence, {
      context: "Rewrite so it's not toxic, be nicer."
    });

    console.log(`Rewritten: "${sentence}" â†’ "${rewritten}"`);

    if (rewritten.length > sentence.length * 3.5) {
      const secondTry = await rw.rewrite(sentence, {
        context: "ONLY SAY THE REWRITE NO INTRO OR LEAD-IN REMOVE TOXICNESS"
      });

      if (secondTry.length > sentence.length * 3.5) {
        rewriteCache.set(sentence, "REMOVED HARMFUL TEXT");
        return "REMOVED HARMFUL TEXT";
      } else {
        rewriteCache.set(sentence, secondTry);
        return secondTry;
      }
    }

    rewriteCache.set(sentence, rewritten);
    return rewritten;
  } catch (err) {
    console.error("âŒ Rewrite failed:", err);
    rewriteCache.set(sentence, sentence);
    return sentence;
  }
}

async function processElement(el) {
  if (el.querySelector('.rewritten-toxic-sentence')) return;

  const text = el.textContent.trim();
  if (!text) return;

  const sentences = splitIntoSentences(text);
  if (!processedSentencesPerElement.has(el)) {
    processedSentencesPerElement.set(el, new Set());
  }

  const processedSet = processedSentencesPerElement.get(el);
  const newSentences = sentences.filter(s => !processedSet.has(s));

  if (newSentences.length === 0) return;

  const toxicCandidates = newSentences.filter(containsBadWord);
  if (toxicCandidates.length === 0) {
    newSentences.forEach(s => {
      rewriteCache.set(s, s);
      processedSet.add(s);
    });
    return;
  }

  const results = await classifySentencesBatch(toxicCandidates);

  for (let i = 0; i < toxicCandidates.length; i++) {
    const sentence = toxicCandidates[i];
    const result = results[i];

    if (!result || !Array.isArray(result) || result.length === 0) {
      rewriteCache.set(sentence, sentence);
      processedSet.add(sentence);
      continue;
    }

    const top = result[0];
    const label = top.label.toLowerCase();
    const score = top.score;

    const isToxic = (label.includes("toxic") && score > TOXIC_SCORE_THRESHOLD);

    if (isToxic) {
      const rewritten = await rewriteSentence(sentence);
      if (rewritten && rewritten !== sentence) {
        await rewriteToxicText(el, sentence, rewritten);
        console.log(`Replaced in DOM: "${sentence}" â†’ "${rewritten}"`);
      }
    } else {
      rewriteCache.set(sentence, sentence);
    }

    processedSet.add(sentence);
  }
}

async function rewriteToxicText(el, sentence, rewrittenSentence) {
  const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT, null, false);
  const textNodes = [];
  let fullText = "";

  while (walker.nextNode()) {
    const node = walker.currentNode;
    textNodes.push(node);
    fullText += node.nodeValue;
  }

  const index = fullText.indexOf(sentence);
  if (index === -1) return;

  let currentIndex = 0;
  let remaining = sentence.length;
  let started = false;
  const nodesToRemove = [];

  for (let i = 0; i < textNodes.length && remaining > 0; i++) {
    const node = textNodes[i];
    const nodeText = node.nodeValue;
    const nodeLength = nodeText.length;

    if (currentIndex + nodeLength < index) {
      currentIndex += nodeLength;
      continue;
    }

    const startInNode = Math.max(0, index - currentIndex);
    const endInNode = Math.min(nodeLength, startInNode + remaining);
    const before = nodeText.slice(0, startInNode);
    const after = nodeText.slice(endInNode);

    if (!started) {
      const span = document.createElement('span');
      span.style.color = `rgb(${globalRGB.r}, ${globalRGB.g}, ${globalRGB.b})`;
      span.classList.add('rewritten-toxic-sentence');
      span.textContent = rewrittenSentence;

      const fragment = document.createDocumentFragment();
      if (before) fragment.appendChild(document.createTextNode(before));
      fragment.appendChild(span);
      if (after) fragment.appendChild(document.createTextNode(after));

      node.parentNode.replaceChild(fragment, node);
      started = true;
    } else {
      nodesToRemove.push(node);
    }

    remaining -= (endInNode - startInNode);
    currentIndex += nodeLength;
  }

  for (const node of nodesToRemove) {
    if (node.parentNode) node.parentNode.removeChild(node);
  }
}

function hasNewUnprocessedSentences() {
  const elements = document.querySelectorAll('p, h1, h2, h3, h4, h5, h6, span');

  for (const el of elements) {
    if (el.querySelector('.rewritten-toxic-sentence')) continue;

    const text = el.textContent.trim();
    if (!text) continue;

    const sentences = splitIntoSentences(text);
    const processed = processedSentencesPerElement.get(el) || new Set();

    for (const s of sentences) {
      if (!processed.has(s)) return true;
    }
  }

  return false;
}

async function runTextRound() {
  createLightBar();
  isTextRoundInProgress = true;
  console.log(`ðŸš€ Starting text round ${roundNumber}...`);

  const elements = document.querySelectorAll('p, h1, h2, h3, h4, h5, h6, span');
  const groups = chunk([...elements], 10);

  for (const group of groups) {
    await Promise.allSettled(group.map(processElement));
  }

  console.log(`âœ… Finished text round ${roundNumber}...`);
  setTimeout(() => {
    removeLightBar();
  }, 500);

  roundNumber++;
  isTextRoundInProgress = false;
}

function createLightBar() {
  if (!document.getElementById('extension-light-bar')) {
    chrome.storage.local.get(['lightBarColor'], (data) => {
      const baseColor = data.lightBarColor || '#008000';
      const rgb = hexToRgb(baseColor);
      globalRGB = rgb;

      const lightBar = document.createElement('div');
      lightBar.id = 'extension-light-bar';
      lightBar.style.position = 'fixed';
      lightBar.style.top = '0';
      lightBar.style.left = '0';
      lightBar.style.width = '100%';
      lightBar.style.height = '50px';
      lightBar.style.zIndex = '9999';
      lightBar.style.pointerEvents = 'none';

      const startColor = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.7)`;
      const endColor = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0)`;

      lightBar.style.background = `linear-gradient(to bottom, ${startColor}, ${endColor})`;

      document.body.appendChild(lightBar);

      const style = document.createElement('style');
      style.id = 'extension-light-bar-style';
      style.innerHTML = `
        #extension-light-bar {
          animation: glow 1.5s infinite ease-in-out;
        }

        @keyframes glow {
          0% {
            background: linear-gradient(to bottom, rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.5), rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0));
          }
          50% {
            background: linear-gradient(to bottom, rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.7), rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0));
          }
          100% {
            background: linear-gradient(to bottom, rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.5), rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0));
          }
        }

        .rewritten-toxic-sentence {
          background: rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.05);
          border-bottom: 1px dashed rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 0.15);
          padding: 0 2px;
        }
      `;
      document.head.appendChild(style);
    });
  }
}

function removeLightBar() {
  const lightBar = document.getElementById('extension-light-bar');
  if (lightBar) {
    lightBar.remove();
  }
  const style = document.getElementById('extension-light-bar-style');
  if (style) style.remove();
}

function injectImageStyles() {
  if (document.getElementById('image-blur-styles')) return;

  const style = document.createElement('style');
  style.id = 'image-blur-styles';
  style.textContent = `
        .${BLURRED_CLASS} {
            filter: blur(8px);
            transition: filter 0.2s ease-in-out;
        }
        .${BLURRED_CLASS}:hover {
            filter: none;
        }
        .${CHECKED_CLASS} {
            /* mark checked images (no visual change) */
        }
    `;
  document.head.appendChild(style);
}

async function fetchImageAsBlob(src) {
  try {
    const response = await fetch(src);
    if (!response.ok) {
      console.warn(`Could not fetch image (CORS or other issue): ${src}`);
      return null;
    }
    return await response.blob();
  } catch (error) {
    console.error(`Error fetching image: ${src}`, error);
    return null;
  }
}

async function createImageSession() {
  if (!('LanguageModel' in self)) {
    console.error("Prompt API is not available in this browser.");
    return;
  }

  const availability = await LanguageModel.availability();
  if (availability === 'unavailable') {
    console.error("AI model is not available on this device.");
    return;
  }

  try {
    lmSession = await LanguageModel.create({
      expectedInputs: [{ type: "image" }],
      expectedOutputs: [{ type: "text", languages: ["en"] }],
      initialPrompts: [
        {
          role: "system",
          content: `You are a text extractor. For each image, extract any visible text. If no text is found, respond only with: NO TEXT.`
        }
      ]
    });
    console.log("AI image session created successfully.");
  } catch (error) {
    console.error("Failed to create AI image session:", error);
  }
}

async function processImageWithAI(img) {
  if (!img || !img.src) return;

  if (img.classList.contains(BLURRED_CLASS) || img.classList.contains(CHECKED_CLASS)) return;

  if (imageTextCache.has(img.src)) {
    const cached = imageTextCache.get(img.src);
    if (cached.decision === 'toxic') {
      img.classList.add(BLURRED_CLASS);
      return;
    } else {
      img.classList.add(CHECKED_CLASS);
      return;
    }
  }

  if (lmSession && lmSession.inputQuota && lmSession.inputUsage !== undefined) {
    try {
      const usageRatio = lmSession.inputUsage / lmSession.inputQuota;
      if (usageRatio > 0.05) {
        console.log("Input quota exceeded 5%, destroying and creating a new image session.");
        try { await lmSession.destroy(); } catch (e) { /* ignore */ }
        lmSession = null;
        await createImageSession();
      }
    } catch (err) {
      console.warn("Could not read lmSession inputUsage/inputQuota:", err);
    }
  }

  try {
    const blob = await fetchImageAsBlob(img.src);
    if (!blob) {
      imageTextCache.set(img.src, { decision: 'no-text' });
      img.classList.add(CHECKED_CLASS);
      return;
    }

    const file = new File([blob], "image.jpg", { type: blob.type });

    const prompt = [{
      role: 'user',
      content: [
        { type: 'text', value: `Extract any text from the image. If there is no text, respond only with the words "NO TEXT".` },
        { type: 'image', value: file }
      ]
    }];

    if (!lmSession) await createImageSession();
    if (!lmSession) {
      console.error("No image session available.");
      imageTextCache.set(img.src, { decision: 'error' });
      img.classList.add(CHECKED_CLASS);
      return;
    }

    const resultRaw = await lmSession.prompt(prompt);
    const resultString = (typeof resultRaw === 'string') ? resultRaw.trim() : (resultRaw?.toString?.() || '').trim();
    const cleanResultUpper = resultString.toUpperCase();

    if (!resultString || cleanResultUpper === 'NO TEXT') {
      console.log("Result: NO TEXT for image", img.src);
      imageTextCache.set(img.src, { decision: 'no-text' });
      img.classList.add(CHECKED_CLASS);
      return;
    }

    const detectedText = resultString;
    console.log("Detected Text (OCR):", detectedText);

    const classification = await classifyDetectedText(detectedText);

    if (classification.decision === 'toxic') {
      console.log(`Image text classified as TOXIC (label=${classification.label}, score=${classification.score}) â€” blurring image.`);
      img.classList.add(BLURRED_CLASS);
      imageTextCache.set(detectedText, classification);
      imageTextCache.set(img.src, classification);
    } else if (classification.decision === 'safe' || classification.decision === 'no-text') {
      console.log(`Image text classified as SAFE (${classification.label || 'none'}) â€” marking checked.`);
      img.classList.add(CHECKED_CLASS);
      imageTextCache.set(detectedText, classification);
      imageTextCache.set(img.src, classification);
    } else {
      console.warn("Classification error â€” marking as checked.");
      img.classList.add(CHECKED_CLASS);
      imageTextCache.set(img.src, { decision: 'error' });
    }

    try {
      if (lmSession && lmSession.inputUsage !== undefined && lmSession.inputQuota !== undefined) {
        console.log(`Image session usage: ${lmSession.inputUsage}/${lmSession.inputQuota}`);
      }
    } catch (err) { /* ignore */ }

  } catch (error) {
    if (!(error instanceof DOMException && error.name === "InvalidStateError")) {
      console.error("Error processing image with AI:", img.src, error);
    }
    img.classList.add(CHECKED_CLASS);
    imageTextCache.set(img.src, { decision: 'error' });
  }
}

function findUnprocessedImages() {
  return Array.from(document.querySelectorAll(`img:not(.${BLURRED_CLASS}):not(.${CHECKED_CLASS})`));
}

async function processImageGroup(group) {
  await Promise.allSettled(group.map(processImageWithAI));
}

async function runImageRound() {
  injectImageStyles();
  isImageRoundInProgress = true;
  console.log('ðŸ”Ž Starting image round...');

  const images = findUnprocessedImages();
  if (images.length === 0) {
    isImageRoundInProgress = false;
    console.log('No new images this round.');
    return;
  }

  const groups = chunk(images, 5);
  for (const g of groups) {
    await processImageGroup(g);
    await new Promise(r => setTimeout(r, 100));
  }

  console.log('âœ… Finished image round.');
  isImageRoundInProgress = false;
}

chrome.storage.local.get('isTheExtensionOn', (result) => {
  isTheExtensionOn = result.isTheExtensionOn;
  console.log("Initial isTheExtensionOn:", isTheExtensionOn);
});

chrome.storage.onChanged.addListener((changes, area) => {
  if (area === 'local' && changes.isTheExtensionOn) {
    isTheExtensionOn = changes.isTheExtensionOn.newValue;
    console.log("isTheExtensionOn changed:", isTheExtensionOn);
  }
});

(async () => {
  if (isTheExtensionOn) {
    try { await runTextRound(); } catch (err) { console.error('Error starting initial text round', err); }
    try { await runImageRound(); } catch (err) { console.error('Error starting initial image round', err); }
  }

  setInterval(async () => {
    if (!isTheExtensionOn) return;
    if (isTextRoundInProgress) return;

    const foundNew = hasNewUnprocessedSentences();
    if (foundNew) {
      console.log('New unprocessed text detected. Starting text round...');
      await runTextRound();
    }
  }, 1000);

  setInterval(async () => {
    if (!isTheExtensionOn) return;
    if (isImageRoundInProgress) return;

    const newImages = findUnprocessedImages();
    if (newImages.length > 0) {
      console.log('New unprocessed images detected. Starting image round...');
      await runImageRound();
    }
  }, 1000);
})();


})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSwyREFBMkQscUJBQXFCLFVBQVUscUJBQXFCO0FBQy9HO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTixvREFBb0QsK0JBQStCO0FBQ25GO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0Esb0NBQW9DLG1CQUFtQjtBQUN2RDs7QUFFQTtBQUNBO0FBQ0EsNENBQTRDLHFCQUFxQixHQUFHLHFCQUFxQjtBQUN6RjtBQUNBLE1BQU0sY0FBYzs7QUFFcEIsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG1CQUFtQjtBQUNyRDtBQUNBOztBQUVBO0FBQ0EsMERBQTBELGNBQWMsU0FBUyxjQUFjO0FBQy9GOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsVUFBVSx3QkFBd0IsY0FBYztBQUNoRCxVQUFVLHlCQUF5QixjQUFjO0FBQ2pEOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVsYXhlZC13ZWIvLi9zcmMvYmFkX3dvcmRzLmpzIiwid2VicGFjazovL3JlbGF4ZWQtd2ViL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3JlbGF4ZWQtd2ViL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9yZWxheGVkLXdlYi93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3JlbGF4ZWQtd2ViL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vcmVsYXhlZC13ZWIvLi9zcmMvY29udGVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgQkFEX1dPUkRTID0gW1wiYWJib1wiLCBcImFib1wiLCBcImFib3J0aW9uXCIsIFwiYWJ1c2VcIiwgXCJhZGRpY3RcIiwgXCJhZGRpY3RzXCIsIFwiYWR1bHRcIiwgXCJhZnJpY2FcIiwgXCJhZnJpY2FuXCIsIFwiYWxsYVwiLCBcImFsbGFoXCIsIFwiYWxsaWdhdG9yYmFpdFwiLCBcImFtYXRldXJcIiwgXCJhbWVyaWNhblwiLCBcImFuYWxcIiwgXCJhbmFsYW5uaWVcIiwgXCJhbmFsc2V4XCIsIFwiYW5naWVcIiwgXCJhbmdyeVwiLCBcImFudXNcIiwgXCJhcmFiXCIsIFwiYXJhYnNcIiwgXCJhcmVvbGFcIiwgXCJhcmdpZVwiLCBcImFyb3VzZWRcIiwgXCJhcnNlXCIsIFwiYXJzZWhvbGVcIiwgXCJhc2lhblwiLCBcImFzc1wiLCBcImFzc2Fzc2luXCIsIFwiYXNzYXNzaW5hdGVcIiwgXCJhc3Nhc3NpbmF0aW9uXCIsIFwiYXNzYXVsdFwiLCBcImFzc2JhZ2dlclwiLCBcImFzc2JsYXN0ZXJcIiwgXCJhc3NjbG93blwiLCBcImFzc2Nvd2JveVwiLCBcImFzc2VzXCIsIFwiYXNzZnVja1wiLCBcImFzc2Z1Y2tlclwiLCBcImFzc2hhdFwiLCBcImFzc2hvbGVcIiwgXCJhc3Nob2xlc1wiLCBcImFzc2hvcmVcIiwgXCJhc3Nqb2NrZXlcIiwgXCJhc3NraXNzXCIsIFwiYXNza2lzc2VyXCIsIFwiYXNza2xvd25cIiwgXCJhc3NsaWNrXCIsIFwiYXNzbGlja2VyXCIsIFwiYXNzbG92ZXJcIiwgXCJhc3NtYW5cIiwgXCJhc3Ntb25rZXlcIiwgXCJhc3NtdW5jaFwiLCBcImFzc211bmNoZXJcIiwgXCJhc3NwYWNrZXJcIiwgXCJhc3NwaXJhdGVcIiwgXCJhc3NwdXBwaWVzXCIsIFwiYXNzcmFuZ2VyXCIsIFwiYXNzd2hvcmVcIiwgXCJhc3N3aXBlXCIsIFwiYXRobGV0ZXNmb290XCIsIFwiYXR0YWNrXCIsIFwiYXVzdHJhbGlhblwiLCBcImJhYmVcIiwgXCJiYWJpZXNcIiwgXCJiYWNrZG9vclwiLCBcImJhY2tkb29ybWFuXCIsIFwiYmFja3NlYXRcIiwgXCJiYWRmdWNrXCIsIFwiYmFsbGxpY2tlclwiLCBcImJhbGxzXCIsIFwiYmFsbHNhY2tcIiwgXCJiYW5naW5nXCIsIFwiYmFwdGlzdFwiLCBcImJhcmVseWxlZ2FsXCIsIFwiYmFyZlwiLCBcImJhcmZhY2VcIiwgXCJiYXJmZmFjZVwiLCBcImJhc3RcIiwgXCJiYXN0YXJkXCIsIFwiYmF6b25nYXNcIiwgXCJiYXpvb21zXCIsIFwiYmVhbmVyXCIsIFwiYmVhc3RcIiwgXCJiZWFzdGFsaXR5XCIsIFwiYmVhc3RpYWxcIiwgXCJiZWFzdGlhbGl0eVwiLCBcImJlYXRvZmZcIiwgXCJiZWF0LW9mZlwiLCBcImJlYXR5b3VybWVhdFwiLCBcImJlYXZlclwiLCBcImJlc3RpYWxcIiwgXCJiZXN0aWFsaXR5XCIsIFwiYmlcIiwgXCJiaWF0Y2hcIiwgXCJiaWJsZVwiLCBcImJpY3VyaW91c1wiLCBcImJpZ2Fzc1wiLCBcImJpZ2Jhc3RhcmRcIiwgXCJiaWdidXR0XCIsIFwiYmlnZ2VyXCIsIFwiYmlzZXh1YWxcIiwgXCJiaS1zZXh1YWxcIiwgXCJiaXRjaFwiLCBcImJpdGNoYXNzXCIsIFwiYml0Y2hlclwiLCBcImJpdGNoZXNcIiwgXCJiaXRjaGV6XCIsIFwiYml0Y2hpblwiLCBcImJpdGNoaW5nXCIsIFwiYml0Y2hzbGFwXCIsIFwiYml0Y2h5XCIsIFwiYml0ZW1lXCIsIFwiYmxhY2tcIiwgXCJibGFja21hblwiLCBcImJsYWNrb3V0XCIsIFwiYmxhY2tzXCIsIFwiYmxpbmRcIiwgXCJibG93XCIsIFwiYmxvd2pvYlwiLCBcImJvYW5nXCIsIFwiYm9nYW5cIiwgXCJib2h1bmtcIiwgXCJib2xsaWNrXCIsIFwiYm9sbG9ja1wiLCBcImJvbWJcIiwgXCJib21iZXJzXCIsIFwiYm9tYmluZ1wiLCBcImJvbWJzXCIsIFwiYm9tZFwiLCBcImJvbmRhZ2VcIiwgXCJib25lclwiLCBcImJvbmdcIiwgXCJib29iXCIsIFwiYm9vYmllc1wiLCBcImJvb2JzXCIsIFwiYm9vYnlcIiwgXCJib29keVwiLCBcImJvb21cIiwgXCJib29uZ1wiLCBcImJvb25nYVwiLCBcImJvb25pZVwiLCBcImJvb3R5XCIsIFwiYm9vdHljYWxsXCIsIFwiYm91bnR5YmFyXCIsIFwiYnJhXCIsIFwiYnJlYTV0XCIsIFwiYnJlYXN0XCIsIFwiYnJlYXN0am9iXCIsIFwiYnJlYXN0bG92ZXJcIiwgXCJicmVhc3RtYW5cIiwgXCJicm90aGVsXCIsIFwiYnVnZ2VyXCIsIFwiYnVnZ2VyZWRcIiwgXCJidWdnZXJ5XCIsIFwiYnVsbGNyYXBcIiwgXCJidWxsZGlrZVwiLCBcImJ1bGxkeWtlXCIsIFwiYnVsbHNoaXRcIiwgXCJidW1ibGVmdWNrXCIsIFwiYnVtZnVja1wiLCBcImJ1bmdhXCIsIFwiYnVuZ2hvbGVcIiwgXCJidXJpZWRcIiwgXCJidXJuXCIsIFwiYnV0Y2hiYWJlc1wiLCBcImJ1dGNoZGlrZVwiLCBcImJ1dGNoZHlrZVwiLCBcImJ1dHRcIiwgXCJidXR0YmFuZ1wiLCBcImJ1dHQtYmFuZ1wiLCBcImJ1dHRmYWNlXCIsIFwiYnV0dGZ1Y2tcIiwgXCJidXR0LWZ1Y2tcIiwgXCJidXR0ZnVja2VyXCIsIFwiYnV0dC1mdWNrZXJcIiwgXCJidXR0ZnVja2Vyc1wiLCBcImJ1dHQtZnVja2Vyc1wiLCBcImJ1dHRoZWFkXCIsIFwiYnV0dG1hblwiLCBcImJ1dHRtdW5jaFwiLCBcImJ1dHRtdW5jaGVyXCIsIFwiYnV0dHBpcmF0ZVwiLCBcImJ1dHRwbHVnXCIsIFwiYnV0dHN0YWluXCIsIFwiYnlhdGNoXCIsIFwiY2Fja2VyXCIsIFwiY2FtZWxqb2NrZXlcIiwgXCJjYW1lbHRvZVwiLCBcImNhbmFkaWFuXCIsIFwiY2FuY2VyXCIsIFwiY2FycGV0bXVuY2hlclwiLCBcImNhcnJ1dGhcIiwgXCJjYXRob2xpY1wiLCBcImNhdGhvbGljc1wiLCBcImNlbWV0ZXJ5XCIsIFwiY2hhdlwiLCBcImNoZXJyeXBvcHBlclwiLCBcImNoaWNrc2xpY2tcIiwgXCJjaGlsZHJlbidzXCIsIFwiY2hpblwiLCBcImNoaW5hbWFuXCIsIFwiY2hpbmFtZW5cIiwgXCJjaGluZXNlXCIsIFwiY2hpbmtcIiwgXCJjaGlua3lcIiwgXCJjaG9hZFwiLCBcImNob2RlXCIsIFwiY2hyaXN0XCIsIFwiY2hyaXN0aWFuXCIsIFwiY2h1cmNoXCIsIFwiY2lnYXJldHRlXCIsIFwiY2lnc1wiLCBcImNsYW1kaWdnZXJcIiwgXCJjbGFtZGl2ZXJcIiwgXCJjbGl0XCIsIFwiY2xpdG9yaXNcIiwgXCJjbG9nd29nXCIsIFwiY29jYWluZVwiLCBcImNvY2tcIiwgXCJjb2NrYmxvY2tcIiwgXCJjb2NrYmxvY2tlclwiLCBcImNvY2tjb3dib3lcIiwgXCJjb2NrZmlnaHRcIiwgXCJjb2NraGVhZFwiLCBcImNvY2trbm9iXCIsIFwiY29ja2xpY2tlclwiLCBcImNvY2tsb3ZlclwiLCBcImNvY2tub2JcIiwgXCJjb2NrcXVlZW5cIiwgXCJjb2NrcmlkZXJcIiwgXCJjb2Nrc21hblwiLCBcImNvY2tzbWl0aFwiLCBcImNvY2tzbW9rZXJcIiwgXCJjb2Nrc3VjZXJcIiwgXCJjb2Nrc3Vja1wiLCBcImNvY2tzdWNrZWRcIiwgXCJjb2Nrc3Vja2VyXCIsIFwiY29ja3N1Y2tpbmdcIiwgXCJjb2NrdGFpbFwiLCBcImNvY2t0ZWFzZVwiLCBcImNvY2t5XCIsIFwiY29oZWVcIiwgXCJjb2l0dXNcIiwgXCJjb2xvclwiLCBcImNvbG9yZWRcIiwgXCJjb2xvdXJlZFwiLCBcImNvbW1pZVwiLCBcImNvbW11bmlzdFwiLCBcImNvbmRvbVwiLCBcImNvbnNlcnZhdGl2ZVwiLCBcImNvbnNwaXJhY3lcIiwgXCJjb29saWVcIiwgXCJjb29seVwiLCBcImNvb25cIiwgXCJjb29uZG9nXCIsIFwiY29wdWxhdGVcIiwgXCJjb3JuaG9sZVwiLCBcImNvcnJ1cHRpb25cIiwgXCJjcmE1aFwiLCBcImNyYWJzXCIsIFwiY3JhY2tcIiwgXCJjcmFja3BpcGVcIiwgXCJjcmFja3dob3JlXCIsIFwiY3JhY2std2hvcmVcIiwgXCJjcmFwXCIsIFwiY3JhcG9sYVwiLCBcImNyYXBwZXJcIiwgXCJjcmFwcHlcIiwgXCJjcmFzaFwiLCBcImNyZWFteVwiLCBcImNyaW1lXCIsIFwiY3JpbWVzXCIsIFwiY3JpbWluYWxcIiwgXCJjcmltaW5hbHNcIiwgXCJjcm90Y2hcIiwgXCJjcm90Y2hqb2NrZXlcIiwgXCJjcm90Y2htb25rZXlcIiwgXCJjcm90Y2hyb3RcIiwgXCJjdW1cIiwgXCJjdW1idWJibGVcIiwgXCJjdW1mZXN0XCIsIFwiY3Vtam9ja2V5XCIsIFwiY3VtbVwiLCBcImN1bW1lclwiLCBcImN1bW1pbmdcIiwgXCJjdW1xdWF0XCIsIFwiY3VtcXVlZW5cIiwgXCJjdW1zaG90XCIsIFwiY3VuaWxpbmd1c1wiLCBcImN1bmlsbGluZ3VzXCIsIFwiY3VublwiLCBcImN1bm5pbGluZ3VzXCIsIFwiY3VubnR0XCIsIFwiY3VudFwiLCBcImN1bnRleWVkXCIsIFwiY3VudGZ1Y2tcIiwgXCJjdW50ZnVja2VyXCIsIFwiY3VudGxpY2tcIiwgXCJjdW50bGlja2VyXCIsIFwiY3VudGxpY2tpbmdcIiwgXCJjdW50c3Vja2VyXCIsIFwiY3liZXJzZXhcIiwgXCJjeWJlcnNsaW1lclwiLCBcImRhZ29cIiwgXCJkYWhtZXJcIiwgXCJkYW1taXRcIiwgXCJkYW1uXCIsIFwiZGFtbmF0aW9uXCIsIFwiZGFtbml0XCIsIFwiZGFya2llXCIsIFwiZGFya3lcIiwgXCJkYXRuaWdnYVwiLCBcImRlYWRcIiwgXCJkZWFwdGhyb2F0XCIsIFwiZGVhdGhcIiwgXCJkZWVwdGhyb2F0XCIsIFwiZGVmZWNhdGVcIiwgXCJkZWdvXCIsIFwiZGVtb25cIiwgXCJkZXBvc2l0XCIsIFwiZGVzaXJlXCIsIFwiZGVzdHJveVwiLCBcImRldGhcIiwgXCJkZXZpbFwiLCBcImRldmlsd29yc2hpcHBlclwiLCBcImRpY2tcIiwgXCJkaWNrYnJhaW5cIiwgXCJkaWNrZm9yYnJhaW5zXCIsIFwiZGlja2hlYWRcIiwgXCJkaWNrbGVzc1wiLCBcImRpY2tsaWNrXCIsIFwiZGlja2xpY2tlclwiLCBcImRpY2ttYW5cIiwgXCJkaWNrd2FkXCIsIFwiZGlja3dlZWRcIiwgXCJkaWRkbGVcIiwgXCJkaWVcIiwgXCJkaWVkXCIsIFwiZGllc1wiLCBcImRpa2VcIiwgXCJkaWxkb1wiLCBcImRpbmdsZWJlcnJ5XCIsIFwiZGlua1wiLCBcImRpcHNoaXRcIiwgXCJkaXBzdGlja1wiLCBcImRpcnR5XCIsIFwiZGlzZWFzZVwiLCBcImRpc2Vhc2VzXCIsIFwiZGlzdHVyYmVkXCIsIFwiZGl2ZVwiLCBcImRpeFwiLCBcImRpeGllZGlrZVwiLCBcImRpeGllZHlrZVwiLCBcImRvZ2dpZXN0eWxlXCIsIFwiZG9nZ3lzdHlsZVwiLCBcImRvbmdcIiwgXCJkb29kb29cIiwgXCJkb28tZG9vXCIsIFwiZG9vbVwiLCBcImRvcGVcIiwgXCJkcmFncXVlZW5cIiwgXCJkcmFncXdlZW5cIiwgXCJkcmlwZGlja1wiLCBcImRydWdcIiwgXCJkcnVua1wiLCBcImRydW5rZW5cIiwgXCJkdW1iXCIsIFwiZHVtYmFzc1wiLCBcImR1bWJiaXRjaFwiLCBcImR1bWJmdWNrXCIsIFwiZHllZmx5XCIsIFwiZHlrZVwiLCBcImVhc3lzbHV0XCIsIFwiZWF0YmFsbHNcIiwgXCJlYXRtZVwiLCBcImVhdHB1c3N5XCIsIFwiZWNzdGFjeVwiLCBcImVqYWN1bGF0ZVwiLCBcImVqYWN1bGF0ZWRcIiwgXCJlamFjdWxhdGluZ1wiLCBcImVqYWN1bGF0aW9uXCIsIFwiZW5lbWFcIiwgXCJlbmVteVwiLCBcImVyZWN0XCIsIFwiZXJlY3Rpb25cIiwgXCJlcm9cIiwgXCJlc2NvcnRcIiwgXCJldGhpb3BpYW5cIiwgXCJldGhuaWNcIiwgXCJldXJvcGVhblwiLCBcImV2bFwiLCBcImV4Y3JlbWVudFwiLCBcImV4ZWN1dGVcIiwgXCJleGVjdXRlZFwiLCBcImV4ZWN1dGlvblwiLCBcImV4ZWN1dGlvbmVyXCIsIFwiZXhwbG9zaW9uXCIsIFwiZmFjZWZ1Y2tlclwiLCBcImZhZWNlc1wiLCBcImZhZ1wiLCBcImZhZ2dpbmdcIiwgXCJmYWdnb3RcIiwgXCJmYWdvdFwiLCBcImZhaWxlZFwiLCBcImZhaWx1cmVcIiwgXCJmYWlyaWVzXCIsIFwiZmFpcnlcIiwgXCJmYWl0aFwiLCBcImZhbm55ZnVja2VyXCIsIFwiZmFydFwiLCBcImZhcnRlZFwiLCBcImZhcnRpbmdcIiwgXCJmYXJ0eVwiLCBcImZhc3RmdWNrXCIsIFwiZmF0XCIsIFwiZmF0YWhcIiwgXCJmYXRhc3NcIiwgXCJmYXRmdWNrXCIsIFwiZmF0ZnVja2VyXCIsIFwiZmF0c29cIiwgXCJmY2tjdW1cIiwgXCJmZWFyXCIsIFwiZmVjZXNcIiwgXCJmZWxhdGlvXCIsIFwiZmVsY2hcIiwgXCJmZWxjaGVyXCIsIFwiZmVsY2hpbmdcIiwgXCJmZWxsYXRpb1wiLCBcImZlbHRjaFwiLCBcImZlbHRjaGVyXCIsIFwiZmVsdGNoaW5nXCIsIFwiZmV0aXNoXCIsIFwiZmlnaHRcIiwgXCJmaWxpcGluYVwiLCBcImZpbGlwaW5vXCIsIFwiZmluZ2VyZm9vZFwiLCBcImZpbmdlcmZ1Y2tcIiwgXCJmaW5nZXJmdWNrZWRcIiwgXCJmaW5nZXJmdWNrZXJcIiwgXCJmaW5nZXJmdWNrZXJzXCIsIFwiZmluZ2VyZnVja2luZ1wiLCBcImZpcmVcIiwgXCJmaXJpbmdcIiwgXCJmaXN0ZXJcIiwgXCJmaXN0ZnVja1wiLCBcImZpc3RmdWNrZWRcIiwgXCJmaXN0ZnVja2VyXCIsIFwiZmlzdGZ1Y2tpbmdcIiwgXCJmaXN0aW5nXCIsIFwiZmxhbmdlXCIsIFwiZmxhc2hlclwiLCBcImZsYXR1bGVuY2VcIiwgXCJmbG9vXCIsIFwiZmx5ZGllXCIsIFwiZmx5ZHllXCIsIFwiZm9rXCIsIFwiZm9uZGxlXCIsIFwiZm9vdGFjdGlvblwiLCBcImZvb3RmdWNrXCIsIFwiZm9vdGZ1Y2tlclwiLCBcImZvb3RsaWNrZXJcIiwgXCJmb290c3RhclwiLCBcImZvcmVcIiwgXCJmb3Jlc2tpblwiLCBcImZvcm5pXCIsIFwiZm9ybmljYXRlXCIsIFwiZm91cnNvbWVcIiwgXCJmb3VydHdlbnR5XCIsIFwiZnJhdWRcIiwgXCJmcmVha2Z1Y2tcIiwgXCJmcmVha3lmdWNrZXJcIiwgXCJmcmVlZnVja1wiLCBcImZ1XCIsIFwiZnViYXJcIiwgXCJmdWNcIiwgXCJmdWNja1wiLCBcImZ1Y2tcIiwgXCJmdWNrYVwiLCBcImZ1Y2thYmxlXCIsIFwiZnVja2Fzc1wiLCBcImZ1Y2tiYWdcIiwgXCJmdWNrYnVkZHlcIiwgXCJmdWNrZWRcIiwgXCJmdWNrZWR1cFwiLCBcImZ1Y2tlclwiLCBcImZ1Y2tlcnNcIiwgXCJmdWNrZmFjZVwiLCBcImZ1Y2tmZXN0XCIsIFwiZnVja2ZyZWFrXCIsIFwiZnVja2ZyaWVuZFwiLCBcImZ1Y2toZWFkXCIsIFwiZnVja2hlclwiLCBcImZ1Y2tpblwiLCBcImZ1Y2tpbmFcIiwgXCJmdWNraW5nXCIsIFwiZnVja2luZ2JpdGNoXCIsIFwiZnVja2lubnV0c1wiLCBcImZ1Y2tpbnJpZ2h0XCIsIFwiZnVja2l0XCIsIFwiZnVja2tub2JcIiwgXCJmdWNrbWVcIiwgXCJmdWNrbWVoYXJkXCIsIFwiZnVja21vbmtleVwiLCBcImZ1Y2tvZmZcIiwgXCJmdWNrcGlnXCIsIFwiZnVja3NcIiwgXCJmdWNrdGFyZFwiLCBcImZ1Y2t3aG9yZVwiLCBcImZ1Y2t5b3VcIiwgXCJmdWRnZXBhY2tlclwiLCBcImZ1Z2x5XCIsIFwiZnVrXCIsIFwiZnVrc1wiLCBcImZ1bmVyYWxcIiwgXCJmdW5mdWNrXCIsIFwiZnVuZ3VzXCIsIFwiZnV1Y2tcIiwgXCJnYW5nYmFuZ1wiLCBcImdhbmdiYW5nZWRcIiwgXCJnYW5nYmFuZ2VyXCIsIFwiZ2FuZ3N0YVwiLCBcImdhdG9yYmFpdFwiLCBcImdheVwiLCBcImdheW11dGhhZnVja2lud2hvcmVcIiwgXCJnYXlzZXhcIiwgXCJnZWV6XCIsIFwiZ2VlemVyXCIsIFwiZ2VuaVwiLCBcImdlbml0YWxcIiwgXCJnZXJtYW5cIiwgXCJnZXRpdG9uXCIsIFwiZ2luXCIsIFwiZ2luem9cIiwgXCJnaXBwXCIsIFwiZ2lybHNcIiwgXCJnaXZlaGVhZFwiLCBcImdsYXplZGRvbnV0XCIsIFwiZ29iXCIsIFwiZ29kXCIsIFwiZ29kYW1taXRcIiwgXCJnb2RkYW1pdFwiLCBcImdvZGRhbW1pdFwiLCBcImdvZGRhbW5cIiwgXCJnb2RkYW1uZWRcIiwgXCJnb2RkYW1uZXNcIiwgXCJnb2RkYW1uaXRcIiwgXCJnb2RkYW1ubXV0aGFmdWNrZXJcIiwgXCJnb2xkZW5zaG93ZXJcIiwgXCJnb25vcnJlaGVhXCIsIFwiZ29uemFnYXNcIiwgXCJnb29rXCIsIFwiZ290b2hlbGxcIiwgXCJnb3lcIiwgXCJnb3lpbVwiLCBcImdyZWFzZWJhbGxcIiwgXCJncmluZ29cIiwgXCJncm9lXCIsIFwiZ3Jvc3NcIiwgXCJncm9zdHVsYXRpb25cIiwgXCJndWJiYVwiLCBcImd1bW1lclwiLCBcImd1blwiLCBcImd5cFwiLCBcImd5cG9cIiwgXCJneXBwXCIsIFwiZ3lwcGllXCIsIFwiZ3lwcG9cIiwgXCJneXBweVwiLCBcImhhbWFzXCIsIFwiaGFuZGpvYlwiLCBcImhhcGFcIiwgXCJoYXJkZXJcIiwgXCJoYXJkb25cIiwgXCJoYXJlbVwiLCBcImhlYWRmdWNrXCIsIFwiaGVhZGxpZ2h0c1wiLCBcImhlYmVcIiwgXCJoZWViXCIsIFwiaGVsbFwiLCBcImhlbmhvdXNlXCIsIFwiaGVyb2luXCIsIFwiaGVycGVzXCIsIFwiaGV0ZXJvc2V4dWFsXCIsIFwiaGlqYWNrXCIsIFwiaGlqYWNrZXJcIiwgXCJoaWphY2tpbmdcIiwgXCJoaWxsYmlsbGllc1wiLCBcImhpbmRvb1wiLCBcImhpc2NvY2tcIiwgXCJoaXRsZXJcIiwgXCJoaXRsZXJpc21cIiwgXCJoaXRsZXJpc3RcIiwgXCJoaXZcIiwgXCJob1wiLCBcImhvYm9cIiwgXCJob2RnaWVcIiwgXCJob2VzXCIsIFwiaG9sZVwiLCBcImhvbGVzdHVmZmVyXCIsIFwiaG9taWNpZGVcIiwgXCJob21vXCIsIFwiaG9tb2JhbmdlcnNcIiwgXCJob21vc2V4dWFsXCIsIFwiaG9uZ2VyXCIsIFwiaG9ua1wiLCBcImhvbmtlcnNcIiwgXCJob25rZXlcIiwgXCJob25reVwiLCBcImhvb2tcIiwgXCJob29rZXJcIiwgXCJob29rZXJzXCIsIFwiaG9vdGVyc1wiLCBcImhvcmVcIiwgXCJob3JrXCIsIFwiaG9yblwiLCBcImhvcm5leVwiLCBcImhvcm5pZXN0XCIsIFwiaG9ybnlcIiwgXCJob3JzZXNoaXRcIiwgXCJob3Nlam9iXCIsIFwiaG9zZXJcIiwgXCJob3N0YWdlXCIsIFwiaG90ZGFtblwiLCBcImhvdHB1c3N5XCIsIFwiaG90dG90cm90XCIsIFwiaHVtbWVyXCIsIFwiaHVza3lcIiwgXCJodXNzeVwiLCBcImh1c3RsZXJcIiwgXCJoeW1lblwiLCBcImh5bWllXCIsIFwiaWJsb3d1XCIsIFwiaWRpb3RcIiwgXCJpZGlvdGljXCIsIFwiaWtleVwiLCBcImlsbGVnYWxcIiwgXCJpbmNlc3RcIiwgXCJpbnNlc3RcIiwgXCJpbnRlcmNvdXJzZVwiLCBcImludGVycmFjaWFsXCIsIFwiaW50aGVhc3NcIiwgXCJpbnRoZWJ1ZmZcIiwgXCJpc3JhZWxcIiwgXCJpc3JhZWxpXCIsIFwiaXNyYWVsJ3NcIiwgXCJpdGFsaWFub1wiLCBcIml0Y2hcIiwgXCJqYWNrYXNzXCIsIFwiamFja29mZlwiLCBcImphY2tzaGl0XCIsIFwiamFja3RoZXJpcHBlclwiLCBcImphZGVcIiwgXCJqYXBcIiwgXCJqYXBhbmVzZVwiLCBcImphcGNyYXBcIiwgXCJqZWJ1c1wiLCBcImplZXpcIiwgXCJqZXJrb2ZmXCIsIFwiamVzdXNcIiwgXCJqZXN1c2NocmlzdFwiLCBcImpld1wiLCBcImpld2lzaFwiLCBcImppZ2FcIiwgXCJqaWdhYm9vXCIsIFwiamlnZ1wiLCBcImppZ2dhXCIsIFwiamlnZ2Fib1wiLCBcImppZ2dlclwiLCBcImppZ2d5XCIsIFwiamloYWRcIiwgXCJqaWpqaWJvb1wiLCBcImppbWZpc2hcIiwgXCJqaXNtXCIsIFwiaml6XCIsIFwiaml6aW1cIiwgXCJqaXpqdWljZVwiLCBcImppem1cIiwgXCJqaXp6XCIsIFwiaml6emltXCIsIFwiaml6enVtXCIsIFwiam9pbnRcIiwgXCJqdWdnYWxvXCIsIFwianVnc1wiLCBcImp1bmdsZWJ1bm55XCIsIFwia2FmZmVyXCIsIFwia2FmZmlyXCIsIFwia2FmZnJlXCIsIFwia2FmaXJcIiwgXCJrYW5ha2VcIiwgXCJraWRcIiwgXCJraWdnZXJcIiwgXCJraWtlXCIsIFwia2lsbFwiLCBcImtpbGxlZFwiLCBcImtpbGxlclwiLCBcImtpbGxpbmdcIiwgXCJraWxsc1wiLCBcImtpbmtcIiwgXCJraW5reVwiLCBcImtpc3Nhc3NcIiwgXCJra2tcIiwgXCJrbmlmZVwiLCBcImtub2NrZXJzXCIsIFwia29ja1wiLCBcImtvbmR1bVwiLCBcImtvb25cIiwgXCJrb3RleFwiLCBcImtyYXBcIiwgXCJrcmFwcHlcIiwgXCJrcmF1dFwiLCBcImt1bVwiLCBcImt1bWJ1YmJsZVwiLCBcImt1bWJ1bGxiZVwiLCBcImt1bW1lclwiLCBcImt1bW1pbmdcIiwgXCJrdW1xdWF0XCIsIFwia3Vtc1wiLCBcImt1bmlsaW5ndXNcIiwgXCJrdW5uaWxpbmd1c1wiLCBcImt1bnRcIiwgXCJreVwiLCBcImt5a2VcIiwgXCJsYWN0YXRlXCIsIFwibGFpZFwiLCBcImxhcGRhbmNlXCIsIFwibGF0aW5cIiwgXCJsZXNiYWluXCIsIFwibGVzYmF5blwiLCBcImxlc2JpYW5cIiwgXCJsZXNiaW5cIiwgXCJsZXNib1wiLCBcImxlelwiLCBcImxlemJlXCIsIFwibGV6YmVmcmllbmRzXCIsIFwibGV6Ym9cIiwgXCJsZXp6XCIsIFwibGV6em9cIiwgXCJsaWJlcmFsXCIsIFwibGliaWRvXCIsIFwibGlja2VyXCIsIFwibGlja21lXCIsIFwibGllc1wiLCBcImxpbWV5XCIsIFwibGltcGRpY2tcIiwgXCJsaW15XCIsIFwibGluZ2VyaWVcIiwgXCJsaXF1b3JcIiwgXCJsaXZlc2V4XCIsIFwibG9hZGVkZ3VuXCIsIFwibG9saXRhXCIsIFwibG9vc2VyXCIsIFwibG9zZXJcIiwgXCJsb3Rpb25cIiwgXCJsb3ZlYm9uZVwiLCBcImxvdmVnb29cIiwgXCJsb3ZlZ3VuXCIsIFwibG92ZWp1aWNlXCIsIFwibG92ZW11c2NsZVwiLCBcImxvdmVwaXN0b2xcIiwgXCJsb3Zlcm9ja2V0XCIsIFwibG93bGlmZVwiLCBcImxzZFwiLCBcImx1YmVqb2JcIiwgXCJsdWNpZmVyXCIsIFwibHVja3ljYW1tZWx0b2VcIiwgXCJsdWdhblwiLCBcImx5bmNoXCIsIFwibWFjYWNhXCIsIFwibWFkXCIsIFwibWFmaWFcIiwgXCJtYWdpY3dhbmRcIiwgXCJtYW1zXCIsIFwibWFuaGF0ZXJcIiwgXCJtYW5wYXN0ZVwiLCBcIm1hcmlqdWFuYVwiLCBcIm1hc3RhYmF0ZVwiLCBcIm1hc3RhYmF0ZXJcIiwgXCJtYXN0ZXJiYXRlXCIsIFwibWFzdGVyYmxhc3RlclwiLCBcIm1hc3RyYWJhdG9yXCIsIFwibWFzdHVyYmF0ZVwiLCBcIm1hc3R1cmJhdGluZ1wiLCBcIm1hdHRyZXNzcHJpbmNlc3NcIiwgXCJtZWF0YmVhdHRlclwiLCBcIm1lYXRyYWNrXCIsIFwibWV0aFwiLCBcIm1leGljYW5cIiwgXCJtZ2dlclwiLCBcIm1nZ29yXCIsIFwibWlja2V5ZmlublwiLCBcIm1pZGVhc3RcIiwgXCJtaWxmXCIsIFwibWlub3JpdHlcIiwgXCJtb2NrZXlcIiwgXCJtb2NraWVcIiwgXCJtb2NreVwiLCBcIm1vZm9cIiwgXCJtb2t5XCIsIFwibW9sZXNcIiwgXCJtb2xlc3RcIiwgXCJtb2xlc3RhdGlvblwiLCBcIm1vbGVzdGVyXCIsIFwibW9sZXN0b3JcIiwgXCJtb25leXNob3RcIiwgXCJtb29uY3JpY2tldFwiLCBcIm1vcm1vblwiLCBcIm1vcm9uXCIsIFwibW9zbGVtXCIsIFwibW9zc2hlYWRcIiwgXCJtb3RoYWZ1Y2tcIiwgXCJtb3RoYWZ1Y2thXCIsIFwibW90aGFmdWNrYXpcIiwgXCJtb3RoYWZ1Y2tlZFwiLCBcIm1vdGhhZnVja2VyXCIsIFwibW90aGFmdWNraW5cIiwgXCJtb3RoYWZ1Y2tpbmdcIiwgXCJtb3RoYWZ1Y2tpbmdzXCIsIFwibW90aGVyZnVja1wiLCBcIm1vdGhlcmZ1Y2tlZFwiLCBcIm1vdGhlcmZ1Y2tlclwiLCBcIm1vdGhlcmZ1Y2tpblwiLCBcIm1vdGhlcmZ1Y2tpbmdcIiwgXCJtb3RoZXJmdWNraW5nc1wiLCBcIm1vdGhlcmxvdmVib25lXCIsIFwibXVmZlwiLCBcIm11ZmZkaXZlXCIsIFwibXVmZmRpdmVyXCIsIFwibXVmZmluZGl2ZXJcIiwgXCJtdWZmbGlrY2VyXCIsIFwibXVsYXR0b1wiLCBcIm11bmNoZXJcIiwgXCJtdW50XCIsIFwibXVyZGVyXCIsIFwibXVyZGVyZXJcIiwgXCJtdXNsaW1cIiwgXCJuYWtlZFwiLCBcIm5hcmNvdGljXCIsIFwibmFzdHlcIiwgXCJuYXN0eWJpdGNoXCIsIFwibmFzdHlob1wiLCBcIm5hc3R5c2x1dFwiLCBcIm5hc3R5d2hvcmVcIiwgXCJuYXppXCIsIFwibmVjcm9cIiwgXCJuZWdyb1wiLCBcIm5lZ3JvZXNcIiwgXCJuZWdyb2lkXCIsIFwibmVncm8nc1wiLCBcIm5pZ1wiLCBcIm5pZ2VyXCIsIFwibmlnZXJpYW5cIiwgXCJuaWdlcmlhbnNcIiwgXCJuaWdnXCIsIFwibmlnZ2FcIiwgXCJuaWdnYWhcIiwgXCJuaWdnYXJhY2NpXCIsIFwibmlnZ2FyZFwiLCBcIm5pZ2dhcmRlZFwiLCBcIm5pZ2dhcmRpbmdcIiwgXCJuaWdnYXJkbGluZXNzXCIsIFwibmlnZ2FyZGxpbmVzcydzXCIsIFwibmlnZ2FyZGx5XCIsIFwibmlnZ2FyZHNcIiwgXCJuaWdnYXJkJ3NcIiwgXCJuaWdnYXpcIiwgXCJuaWdnZXJcIiwgXCJuaWdnZXJoZWFkXCIsIFwibmlnZ2VyaG9sZVwiLCBcIm5pZ2dlcnNcIiwgXCJuaWdnZXInc1wiLCBcIm5pZ2dsZVwiLCBcIm5pZ2dsZWRcIiwgXCJuaWdnbGVzXCIsIFwibmlnZ2xpbmdcIiwgXCJuaWdnbGluZ3NcIiwgXCJuaWdnb3JcIiwgXCJuaWdndXJcIiwgXCJuaWdsZXRcIiwgXCJuaWdub2dcIiwgXCJuaWdyXCIsIFwibmlncmFcIiwgXCJuaWdyZVwiLCBcIm5pcFwiLCBcIm5pcHBsZVwiLCBcIm5pcHBsZXJpbmdcIiwgXCJuaXR0aXRcIiwgXCJubGdnZXJcIiwgXCJubGdnb3JcIiwgXCJub2Z1Y2tpbmd3YXlcIiwgXCJub29rXCIsIFwibm9va2V5XCIsIFwibm9va2llXCIsIFwibm9vbmFuXCIsIFwibm9vbmVyXCIsIFwibnVkZVwiLCBcIm51ZGdlclwiLCBcIm51a2VcIiwgXCJudXRmdWNrZXJcIiwgXCJueW1waFwiLCBcIm9udGhlcmFnXCIsIFwib3JhbFwiLCBcIm9yZ2FcIiwgXCJvcmdhc2ltXCIsIFwib3JnYXNtXCIsIFwib3JnaWVzXCIsIFwib3JneVwiLCBcIm9zYW1hXCIsIFwicGFraVwiLCBcInBhbGVzaW1pYW5cIiwgXCJwYWxlc3RpbmlhblwiLCBcInBhbnNpZXNcIiwgXCJwYW5zeVwiLCBcInBhbnRpXCIsIFwicGFudGllc1wiLCBcInBheW9cIiwgXCJwZWFybG5lY2tsYWNlXCIsIFwicGVja1wiLCBcInBlY2tlclwiLCBcInBlY2tlcndvb2RcIiwgXCJwZWVcIiwgXCJwZWVob2xlXCIsIFwicGVlLXBlZVwiLCBcInBlZXBzaG93XCIsIFwicGVlcHNocHdcIiwgXCJwZW5keVwiLCBcInBlbmV0cmF0aW9uXCIsIFwicGVuaTVcIiwgXCJwZW5pbGVcIiwgXCJwZW5pc1wiLCBcInBlbmlzZXNcIiwgXCJwZW50aG91c2VcIiwgXCJwZXJpb2RcIiwgXCJwZXJ2XCIsIFwicGhvbmVzZXhcIiwgXCJwaHVrXCIsIFwicGh1a2VkXCIsIFwicGh1a2luZ1wiLCBcInBodWtrZWRcIiwgXCJwaHVra2luZ1wiLCBcInBodW5na3lcIiwgXCJwaHVxXCIsIFwicGk1NVwiLCBcInBpY2FuaW5ueVwiLCBcInBpY2NhbmlubnlcIiwgXCJwaWNrYW5pbm55XCIsIFwicGlrZXJcIiwgXCJwaWtleVwiLCBcInBpa3lcIiwgXCJwaW1wXCIsIFwicGltcGVkXCIsIFwicGltcGVyXCIsIFwicGltcGp1aWNcIiwgXCJwaW1wanVpY2VcIiwgXCJwaW1wc2ltcFwiLCBcInBpbmRpY2tcIiwgXCJwaXNzXCIsIFwicGlzc2VkXCIsIFwicGlzc2VyXCIsIFwicGlzc2VzXCIsIFwicGlzc2hlYWRcIiwgXCJwaXNzaW5cIiwgXCJwaXNzaW5nXCIsIFwicGlzc29mZlwiLCBcInBpc3RvbFwiLCBcInBpeGllXCIsIFwicGl4eVwiLCBcInBsYXlib3lcIiwgXCJwbGF5Z2lybFwiLCBcInBvY2hhXCIsIFwicG9jaG9cIiwgXCJwb2NrZXRwb29sXCIsIFwicG9obVwiLCBcInBvbGFja1wiLCBcInBvbVwiLCBcInBvbW1pZVwiLCBcInBvbW15XCIsIFwicG9vXCIsIFwicG9vblwiLCBcInBvb250YW5nXCIsIFwicG9vcFwiLCBcInBvb3BlclwiLCBcInBvb3BlcnNjb29wZXJcIiwgXCJwb29waW5nXCIsIFwicG9vcndoaXRldHJhc2hcIiwgXCJwb3BpbXBcIiwgXCJwb3JjaG1vbmtleVwiLCBcInBvcm5cIiwgXCJwb3JuZmxpY2tcIiwgXCJwb3Jua2luZ1wiLCBcInBvcm5vXCIsIFwicG9ybm9ncmFwaHlcIiwgXCJwb3JucHJpbmNlc3NcIiwgXCJwb3RcIiwgXCJwb3ZlcnR5XCIsIFwicHJlbWF0dXJlXCIsIFwicHJpY1wiLCBcInByaWNrXCIsIFwicHJpY2toZWFkXCIsIFwicHJpbWV0aW1lXCIsIFwicHJvcGFnYW5kYVwiLCBcInByb3NcIiwgXCJwcm9zdGl0dXRlXCIsIFwicHJvdGVzdGFudFwiLCBcInB1NTVpXCIsIFwicHU1NXlcIiwgXCJwdWJlXCIsIFwicHViaWNcIiwgXCJwdWJpY2xpY2VcIiwgXCJwdWRcIiwgXCJwdWRib3lcIiwgXCJwdWRkXCIsIFwicHVkZGJveVwiLCBcInB1a2VcIiwgXCJwdW50YW5nXCIsIFwicHVyaW5hcHJpY25lc3NcIiwgXCJwdXNzXCIsIFwicHVzc2llXCIsIFwicHVzc2llc1wiLCBcInB1c3N5XCIsIFwicHVzc3ljYXRcIiwgXCJwdXNzeWVhdGVyXCIsIFwicHVzc3lmdWNrZXJcIiwgXCJwdXNzeWxpY2tlclwiLCBcInB1c3N5bGlwc1wiLCBcInB1c3N5bG92ZXJcIiwgXCJwdXNzeXBvdW5kZXJcIiwgXCJwdXN5XCIsIFwicXVhc2hpZVwiLCBcInF1ZWVmXCIsIFwicXVlZXJcIiwgXCJxdWlja2llXCIsIFwicXVpbVwiLCBcInJhOHNcIiwgXCJyYWJiaVwiLCBcInJhY2lhbFwiLCBcInJhY2lzdFwiLCBcInJhZGljYWxcIiwgXCJyYWRpY2Fsc1wiLCBcInJhZ2hlYWRcIiwgXCJyYW5keVwiLCBcInJhcGVcIiwgXCJyYXBlZFwiLCBcInJhcGVyXCIsIFwicmFwaXN0XCIsIFwicmVhcmVuZFwiLCBcInJlYXJlbnRyeVwiLCBcInJlY3R1bVwiLCBcInJlZGxpZ2h0XCIsIFwicmVkbmVja1wiLCBcInJlZWZlclwiLCBcInJlZXN0aWVcIiwgXCJyZWZ1Z2VlXCIsIFwicmVqZWN0XCIsIFwicmVtYWluc1wiLCBcInJlbnRhZnVja1wiLCBcInJlcHVibGljYW5cIiwgXCJyZXJlXCIsIFwicmV0YXJkXCIsIFwicmV0YXJkZWRcIiwgXCJyaWJiZWRcIiwgXCJyaWdnZXJcIiwgXCJyaW1qb2JcIiwgXCJyaW1taW5nXCIsIFwicm9hY2hcIiwgXCJyb2JiZXJcIiwgXCJyb3VuZGV5ZVwiLCBcInJ1bXBcIiwgXCJydXNza2lcIiwgXCJydXNza2llXCIsIFwic2FkaXNcIiwgXCJzYWRvbVwiLCBcInNhbWNrZGFkZHlcIiwgXCJzYW5kbVwiLCBcInNhbmRuaWdnZXJcIiwgXCJzYXRhblwiLCBcInNjYWdcIiwgXCJzY2FsbHl3YWdcIiwgXCJzY2F0XCIsIFwic2NobG9uZ1wiLCBcInNjcmV3XCIsIFwic2NyZXd5b3VcIiwgXCJzY3JvdHVtXCIsIFwic2N1bVwiLCBcInNlbWVuXCIsIFwic2VwcG9cIiwgXCJzZXJ2YW50XCIsIFwic2V4XCIsIFwic2V4ZWRcIiwgXCJzZXhmYXJtXCIsIFwic2V4aG91bmRcIiwgXCJzZXhob3VzZVwiLCBcInNleGluZ1wiLCBcInNleGtpdHRlblwiLCBcInNleHBvdFwiLCBcInNleHNsYXZlXCIsIFwic2V4dG9nb1wiLCBcInNleHRveVwiLCBcInNleHRveXNcIiwgXCJzZXh1YWxcIiwgXCJzZXh1YWxseVwiLCBcInNleHdob3JlXCIsIFwic2V4eVwiLCBcInNleHltb21hXCIsIFwic2V4eS1zbGltXCIsIFwic2hhZ1wiLCBcInNoYWdnaW5cIiwgXCJzaGFnZ2luZ1wiLCBcInNoYXRcIiwgXCJzaGF2XCIsIFwic2hhd3R5cGltcFwiLCBcInNoZWVuZXlcIiwgXCJzaGhpdFwiLCBcInNoaW5vbGFcIiwgXCJzaGl0XCIsIFwic2hpdGFzc1wiLCBcInNoaXRjYW5cIiwgXCJzaGl0ZGlja1wiLCBcInNoaXRlXCIsIFwic2hpdGVhdGVyXCIsIFwic2hpdGVkXCIsIFwic2hpdGZhY2VcIiwgXCJzaGl0ZmFjZWRcIiwgXCJzaGl0Zml0XCIsIFwic2hpdGZvcmJyYWluc1wiLCBcInNoaXRmdWNrXCIsIFwic2hpdGZ1Y2tlclwiLCBcInNoaXRmdWxsXCIsIFwic2hpdGhhcGVuc1wiLCBcInNoaXRoYXBwZW5zXCIsIFwic2hpdGhlYWRcIiwgXCJzaGl0aG91c2VcIiwgXCJzaGl0aW5nXCIsIFwic2hpdGxpc3RcIiwgXCJzaGl0b2xhXCIsIFwic2hpdG91dG9mbHVja1wiLCBcInNoaXRzXCIsIFwic2hpdHN0YWluXCIsIFwic2hpdHRlZFwiLCBcInNoaXR0ZXJcIiwgXCJzaGl0dGluZ1wiLCBcInNoaXR0eVwiLCBcInNob290XCIsIFwic2hvb3RpbmdcIiwgXCJzaG9ydGZ1Y2tcIiwgXCJzaG93dGltZVwiLCBcInNpY2tcIiwgXCJzaXNzeVwiLCBcInNpeHNpeHNpeFwiLCBcInNpeHR5bmluZVwiLCBcInNpeHR5bmluZXJcIiwgXCJza2Fua1wiLCBcInNrYW5rYml0Y2hcIiwgXCJza2Fua2Z1Y2tcIiwgXCJza2Fua3dob3JlXCIsIFwic2thbmt5XCIsIFwic2thbmt5Yml0Y2hcIiwgXCJza2Fua3l3aG9yZVwiLCBcInNraW5mbHV0ZVwiLCBcInNrdW1cIiwgXCJza3VtYmFnXCIsIFwic2xhbnRcIiwgXCJzbGFudGV5ZVwiLCBcInNsYXBwZXJcIiwgXCJzbGF1Z2h0ZXJcIiwgXCJzbGF2XCIsIFwic2xhdmVcIiwgXCJzbGF2ZWRyaXZlclwiLCBcInNsZWV6ZWJhZ1wiLCBcInNsZWV6ZWJhbGxcIiwgXCJzbGlkZWl0aW5cIiwgXCJzbGltZVwiLCBcInNsaW1lYmFsbFwiLCBcInNsaW1lYnVja2V0XCIsIFwic2xvcGVoZWFkXCIsIFwic2xvcGV5XCIsIFwic2xvcHlcIiwgXCJzbHV0XCIsIFwic2x1dHNcIiwgXCJzbHV0dFwiLCBcInNsdXR0aW5nXCIsIFwic2x1dHR5XCIsIFwic2x1dHdlYXJcIiwgXCJzbHV0d2hvcmVcIiwgXCJzbWFja1wiLCBcInNtYWNrdGhlbW9ua2V5XCIsIFwic211dFwiLCBcInNuYXRjaFwiLCBcInNuYXRjaHBhdGNoXCIsIFwic25pZ2dlclwiLCBcInNuaWdnZXJlZFwiLCBcInNuaWdnZXJpbmdcIiwgXCJzbmlnZ2Vyc1wiLCBcInNuaWdnZXInc1wiLCBcInNuaXBlclwiLCBcInNub3RcIiwgXCJzbm93YmFja1wiLCBcInNub3duaWdnZXJcIiwgXCJzb2JcIiwgXCJzb2RvbVwiLCBcInNvZG9taXNlXCIsIFwic29kb21pdGVcIiwgXCJzb2RvbWl6ZVwiLCBcInNvZG9teVwiLCBcInNvbm9mYWJpdGNoXCIsIFwic29ub2ZiaXRjaFwiLCBcInNvb3R5XCIsIFwic29zXCIsIFwic292aWV0XCIsIFwic3BhZ2hldHRpYmVuZGVyXCIsIFwic3BhZ2hldHRpbmlnZ2VyXCIsIFwic3BhbmtcIiwgXCJzcGFua3RoZW1vbmtleVwiLCBcInNwZXJtXCIsIFwic3Blcm1hY2lkZVwiLCBcInNwZXJtYmFnXCIsIFwic3Blcm1oZWFyZGVyXCIsIFwic3Blcm1oZXJkZXJcIiwgXCJzcGljXCIsIFwic3BpY2tcIiwgXCJzcGlnXCIsIFwic3BpZ290dHlcIiwgXCJzcGlrXCIsIFwic3BpdFwiLCBcInNwaXR0ZXJcIiwgXCJzcGxpdHRhaWxcIiwgXCJzcG9vZ2VcIiwgXCJzcHJlYWRlYWdsZVwiLCBcInNwdW5rXCIsIFwic3B1bmt5XCIsIFwic3F1YXdcIiwgXCJzdGFnZ1wiLCBcInN0aWZmeVwiLCBcInN0cmFwb25cIiwgXCJzdHJpbmdlclwiLCBcInN0cmlwY2x1YlwiLCBcInN0cm9rZVwiLCBcInN0cm9raW5nXCIsIFwic3R1cGlkXCIsIFwic3R1cGlkZnVja1wiLCBcInN0dXBpZGZ1Y2tlclwiLCBcInN1Y2tcIiwgXCJzdWNrZGlja1wiLCBcInN1Y2tlclwiLCBcInN1Y2ttZVwiLCBcInN1Y2tteWFzc1wiLCBcInN1Y2tteWRpY2tcIiwgXCJzdWNrbXl0aXRcIiwgXCJzdWNrb2ZmXCIsIFwic3VpY2lkZVwiLCBcInN3YWxsb3dcIiwgXCJzd2FsbG93ZXJcIiwgXCJzd2Fsb3dcIiwgXCJzd2FzdGlrYVwiLCBcInN3ZWV0bmVzc1wiLCBcInN5cGhpbGlzXCIsIFwidGFib29cIiwgXCJ0YWZmXCIsIFwidGFtcG9uXCIsIFwidGFuZ1wiLCBcInRhbnRyYVwiLCBcInRhcmJhYnlcIiwgXCJ0YXJkXCIsIFwidGVhdFwiLCBcInRlcnJvclwiLCBcInRlcnJvcmlzdFwiLCBcInRlc3RlXCIsIFwidGVzdGljbGVcIiwgXCJ0ZXN0aWNsZXNcIiwgXCJ0aGlja2xpcHNcIiwgXCJ0aGlyZGV5ZVwiLCBcInRoaXJkbGVnXCIsIFwidGhyZWVzb21lXCIsIFwidGhyZWV3YXlcIiwgXCJ0aW1iZXJuaWdnZXJcIiwgXCJ0aW5rbGVcIiwgXCJ0aXRcIiwgXCJ0aXRiaXRuaXBwbHlcIiwgXCJ0aXRmdWNrXCIsIFwidGl0ZnVja2VyXCIsIFwidGl0ZnVja2luXCIsIFwidGl0am9iXCIsIFwidGl0bGlja2VyXCIsIFwidGl0bG92ZXJcIiwgXCJ0aXRzXCIsIFwidGl0dGllXCIsIFwidGl0dGllc1wiLCBcInRpdHR5XCIsIFwidG50XCIsIFwidG9pbGV0XCIsIFwidG9uZ2V0aHJ1c3RlclwiLCBcInRvbmd1ZVwiLCBcInRvbmd1ZXRocnVzdFwiLCBcInRvbmd1ZXRyYW1wXCIsIFwidG9ydHVyXCIsIFwidG9ydHVyZVwiLCBcInRvc3NlclwiLCBcInRvd2VsaGVhZFwiLCBcInRyYWlsZXJ0cmFzaFwiLCBcInRyYW1wXCIsIFwidHJhbm5pZVwiLCBcInRyYW5ueVwiLCBcInRyYW5zZXh1YWxcIiwgXCJ0cmFuc3NleHVhbFwiLCBcInRyYW5zdmVzdGl0ZVwiLCBcInRyaXBsZXhcIiwgXCJ0cmlzZXh1YWxcIiwgXCJ0cm9qYW5cIiwgXCJ0cm90c1wiLCBcInR1Y2thaG9lXCIsIFwidHVubmVsb2Zsb3ZlXCIsIFwidHVyZFwiLCBcInR1cm5vblwiLCBcInR3YXRcIiwgXCJ0d2lua1wiLCBcInR3aW5raWVcIiwgXCJ0d29iaXR3aG9yZVwiLCBcInVja1wiLCBcInVrXCIsIFwidW5mdWNrYWJsZVwiLCBcInVwc2tpcnRcIiwgXCJ1cHRoZWFzc1wiLCBcInVwdGhlYnV0dFwiLCBcInVyaW5hcnlcIiwgXCJ1cmluYXRlXCIsIFwidXJpbmVcIiwgXCJ1c2FtYVwiLCBcInV0ZXJ1c1wiLCBcInZhZ2luYVwiLCBcInZhZ2luYWxcIiwgXCJ2YXRpY2FuXCIsIFwidmliclwiLCBcInZpYnJhdGVyXCIsIFwidmlicmF0b3JcIiwgXCJ2aWV0Y29uZ1wiLCBcInZpb2xlbmNlXCIsIFwidmlyZ2luXCIsIFwidmlyZ2luYnJlYWtlclwiLCBcInZvbWl0XCIsIFwidnVsdmFcIiwgXCJ3YWJcIiwgXCJ3YW5rXCIsIFwid2Fua2VyXCIsIFwid2Fua2luZ1wiLCBcIndheXN0ZWRcIiwgXCJ3ZWFwb25cIiwgXCJ3ZWVuaWVcIiwgXCJ3ZWV3ZWVcIiwgXCJ3ZWxjaGVyXCIsIFwid2VsZmFyZVwiLCBcIndldGJcIiwgXCJ3ZXRiYWNrXCIsIFwid2V0c3BvdFwiLCBcIndoYWNrZXJcIiwgXCJ3aGFzaFwiLCBcIndoaWdnZXJcIiwgXCJ3aGlza2V5XCIsIFwid2hpc2tleWRpY2tcIiwgXCJ3aGlza3lkaWNrXCIsIFwid2hpdFwiLCBcIndoaXRlbmlnZ2VyXCIsIFwid2hpdGVzXCIsIFwid2hpdGV0cmFzaFwiLCBcIndoaXRleVwiLCBcIndoaXpcIiwgXCJ3aG9wXCIsIFwid2hvcmVcIiwgXCJ3aG9yZWZ1Y2tlclwiLCBcIndob3JlaG91c2VcIiwgXCJ3aWdnZXJcIiwgXCJ3aWxsaWVcIiwgXCJ3aWxsaWV3YW5rZXJcIiwgXCJ3aWxseVwiLCBcInduXCIsIFwid29nXCIsIFwid29tZW4nc1wiLCBcIndvcFwiLCBcInd0ZlwiLCBcInd1c3NcIiwgXCJ3dXp6aWVcIiwgXCJ4dGNcIiwgXCJ4eHhcIiwgXCJ5YW5rZWVcIiwgXCJ5ZWxsb3dtYW5cIiwgXCJ6aWdhYm9cIiwgXCJ6aXBwZXJoZWFkXCJdOyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0IHsgQkFEX1dPUkRTIH0gZnJvbSAnLi9iYWRfd29yZHMuanMnO1xuXG5jb25zdCBCQURfV09SRFNfU0VUID0gbmV3IFNldChCQURfV09SRFMubWFwKHcgPT4gdy50b0xvd2VyQ2FzZSgpKSk7XG5jb25zdCByZXdyaXRlQ2FjaGUgPSBuZXcgTWFwKCk7XG5jb25zdCBwcm9jZXNzZWRTZW50ZW5jZXNQZXJFbGVtZW50ID0gbmV3IFdlYWtNYXAoKTtcblxubGV0IHJld3JpdGVyID0gbnVsbDtcbmxldCBsbVNlc3Npb24gPSBudWxsO1xubGV0IHJvdW5kTnVtYmVyID0gMTtcbmxldCBpc1RleHRSb3VuZEluUHJvZ3Jlc3MgPSBmYWxzZTtcbmxldCBpc0ltYWdlUm91bmRJblByb2dyZXNzID0gZmFsc2U7XG5sZXQgaXNUaGVFeHRlbnNpb25PbiA9IGZhbHNlO1xubGV0IGdsb2JhbFJHQiA9IG51bGw7XG5cbmNvbnN0IFRPWElDX1NDT1JFX1RIUkVTSE9MRCA9IDAuODtcblxuY29uc3QgQkxVUlJFRF9DTEFTUyA9ICdjaHJvbWUtZXh0LWJsdXJyZWQtaW1hZ2UnO1xuY29uc3QgQ0hFQ0tFRF9DTEFTUyA9ICdjaHJvbWUtZXh0LWNoZWNrZWQtaW1hZ2UnO1xuXG5jb25zdCBpbWFnZVRleHRDYWNoZSA9IG5ldyBNYXAoKTtcblxuZnVuY3Rpb24gc3BsaXRJbnRvU2VudGVuY2VzKHRleHQpIHtcbiAgY29uc3Qgc2VudGVuY2VFbmRpbmdzID0gLyhbLiE/XSlcXHMrL2c7XG4gIHJldHVybiB0ZXh0LnNwbGl0KHNlbnRlbmNlRW5kaW5ncylcbiAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgLm1hcCgoc2VudGVuY2UsIGluZGV4LCBhcnJheSkgPT4ge1xuICAgICAgaWYgKGluZGV4ICUgMiA9PT0gMCkgcmV0dXJuIHNlbnRlbmNlLnRyaW0oKSArIChhcnJheVtpbmRleCArIDFdIHx8ICcnKS50cmltKCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9KVxuICAgIC5maWx0ZXIoQm9vbGVhbik7XG59XG5cbmZ1bmN0aW9uIGNvbnRhaW5zQmFkV29yZCh0ZXh0KSB7XG4gIGNvbnN0IHdvcmRzID0gdGV4dC50b0xvd2VyQ2FzZSgpLm1hdGNoKC9cXGJcXHcrXFxiL2cpO1xuICBpZiAoIXdvcmRzKSByZXR1cm4gZmFsc2U7XG4gIHJldHVybiB3b3Jkcy5zb21lKHcgPT4gQkFEX1dPUkRTX1NFVC5oYXModykpO1xufVxuXG5mdW5jdGlvbiBjaHVuayhhcnJheSwgc2l6ZSkge1xuICByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogTWF0aC5jZWlsKGFycmF5Lmxlbmd0aCAvIHNpemUpIH0sIChfLCBpKSA9PlxuICAgIGFycmF5LnNsaWNlKGkgKiBzaXplLCBpICogc2l6ZSArIHNpemUpXG4gICk7XG59XG5cbmZ1bmN0aW9uIGhleFRvUmdiKGhleCkge1xuICBjb25zdCByZXN1bHQgPSAvXiM/KFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkoW2EtZlxcZF17Mn0pJC9pLmV4ZWMoaGV4KTtcbiAgcmV0dXJuIHJlc3VsdCA/IHtcbiAgICByOiBwYXJzZUludChyZXN1bHRbMV0sIDE2KSxcbiAgICBnOiBwYXJzZUludChyZXN1bHRbMl0sIDE2KSxcbiAgICBiOiBwYXJzZUludChyZXN1bHRbM10sIDE2KVxuICB9IDogeyByOiAwLCBnOiAyNTUsIGI6IDAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY2xhc3NpZnlTZW50ZW5jZXNCYXRjaChzZW50ZW5jZXMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgIGNocm9tZS5ydW50aW1lLnNlbmRNZXNzYWdlKHsgYWN0aW9uOiBcImNsYXNzaWZ5QmF0Y2hcIiwgc2VudGVuY2VzIH0sIChyZXNwb25zZSkgPT4ge1xuICAgICAgaWYgKGNocm9tZS5ydW50aW1lLmxhc3RFcnJvciB8fCAhcmVzcG9uc2UpIHJlc29sdmUoW10pO1xuICAgICAgZWxzZSByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNsYXNzaWZ5RGV0ZWN0ZWRUZXh0KHRleHQpIHtcbiAgaWYgKCF0ZXh0IHx8IHRleHQudHJpbSgpID09PSAnJykgcmV0dXJuIHsgZGVjaXNpb246ICduby10ZXh0JyB9O1xuXG4gIGNvbnN0IGNhY2hlS2V5ID0gdGV4dC50cmltKCk7XG4gIGlmIChpbWFnZVRleHRDYWNoZS5oYXMoY2FjaGVLZXkpKSB7XG4gICAgcmV0dXJuIGltYWdlVGV4dENhY2hlLmdldChjYWNoZUtleSk7XG4gIH1cblxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZSh7IGFjdGlvbjogJ2NsYXNzaWZ5JywgdGV4dCB9LCAocmVzcG9uc2UpID0+IHtcbiAgICAgIGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IgfHwgIXJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IHsgZGVjaXNpb246ICdlcnJvcicgfTtcbiAgICAgICAgaW1hZ2VUZXh0Q2FjaGUuc2V0KGNhY2hlS2V5LCByZXMpO1xuICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXMpO1xuICAgICAgfVxuXG4gICAgICB0cnkge1xuICAgICAgICBsZXQgdG9wID0gbnVsbDtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzcG9uc2UpICYmIHJlc3BvbnNlLmxlbmd0aCA+IDApIHRvcCA9IHJlc3BvbnNlWzBdO1xuICAgICAgICBlbHNlIGlmIChyZXNwb25zZSAmJiByZXNwb25zZVswXSkgdG9wID0gcmVzcG9uc2VbMF07XG5cbiAgICAgICAgaWYgKCF0b3ApIHtcbiAgICAgICAgICBjb25zdCByZXMgPSB7IGRlY2lzaW9uOiAnc2FmZScgfTtcbiAgICAgICAgICBpbWFnZVRleHRDYWNoZS5zZXQoY2FjaGVLZXksIHJlcyk7XG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUocmVzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxhYmVsID0gKHRvcC5sYWJlbCB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgY29uc3Qgc2NvcmUgPSB0eXBlb2YgdG9wLnNjb3JlID09PSAnbnVtYmVyJyA/IHRvcC5zY29yZSA6IHBhcnNlRmxvYXQodG9wLnNjb3JlIHx8IDApO1xuICAgICAgICBjb25zdCBpc1RveGljID0gbGFiZWwuaW5jbHVkZXMoJ3RveGljJykgJiYgc2NvcmUgPj0gVE9YSUNfU0NPUkVfVEhSRVNIT0xEO1xuXG4gICAgICAgIGNvbnN0IHJlcyA9IHtcbiAgICAgICAgICBkZWNpc2lvbjogaXNUb3hpYyA/ICd0b3hpYycgOiAnc2FmZScsXG4gICAgICAgICAgbGFiZWwsXG4gICAgICAgICAgc2NvcmVcbiAgICAgICAgfTtcblxuICAgICAgICBpbWFnZVRleHRDYWNoZS5zZXQoY2FjaGVLZXksIHJlcyk7XG4gICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zdCByZXMgPSB7IGRlY2lzaW9uOiAnZXJyb3InIH07XG4gICAgICAgIGltYWdlVGV4dENhY2hlLnNldChjYWNoZUtleSwgcmVzKTtcbiAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZVJld3JpdGVyKCkge1xuICBpZiAocmV3cml0ZXIpIHJldHVybiByZXdyaXRlcjtcblxuICBpZiAoISgnUmV3cml0ZXInIGluIHNlbGYpKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIFJld3JpdGVyIEFQSSBub3Qgc3VwcG9ydGVkIGluIHRoaXMgZW52aXJvbm1lbnQuJyk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGF2YWlsYWJpbGl0eSA9IGF3YWl0IFJld3JpdGVyLmF2YWlsYWJpbGl0eSgpO1xuICAgIGlmIChhdmFpbGFiaWxpdHkgPT09ICd1bmF2YWlsYWJsZScpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBSZXdyaXRlciBBUEkgdW5hdmFpbGFibGUuJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnSW5pdGlhbGl6aW5nIFJld3JpdGVyLi4uJyk7XG5cbiAgICByZXdyaXRlciA9IGF3YWl0IFJld3JpdGVyLmNyZWF0ZSh7XG4gICAgICBzaGFyZWRDb250ZXh0OiAnT05MWSByZXdyaXRpbmcgdG94aWMgdGV4dCB0byBiZSBuaWNlL2hhcm1sZXNzLiBPbmx5IG91dHB1dCByZXdyaXRlLCBubyBpbnRyby4nLFxuICAgICAgdG9uZTogJ21vcmUtZm9ybWFsJyxcbiAgICAgIGZvcm1hdDogJ3BsYWluLXRleHQnLFxuICAgICAgbGVuZ3RoOiAnc2hvcnRlcicsXG4gICAgICBtb25pdG9yKG0pIHtcbiAgICAgICAgbS5hZGRFdmVudExpc3RlbmVyKFwiZG93bmxvYWRwcm9ncmVzc1wiLCBlID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFJld3JpdGVyIGRvd25sb2FkIHByb2dyZXNzOiAke01hdGgucm91bmQoKGUubG9hZGVkIC8gZS50b3RhbCkgKiAxMDApfSVgKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXdyaXRlciBkb3dubG9hZCBwcm9ncmVzcyBldmVudCcsIGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zb2xlLmxvZygnUmV3cml0ZXIgaW5pdGlhbGl6ZWQuJyk7XG4gICAgcmV0dXJuIHJld3JpdGVyO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFJld3JpdGVyIGluaXRpYWxpemF0aW9uIGZhaWxlZDpcIiwgZXJyKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiByZXdyaXRlU2VudGVuY2Uoc2VudGVuY2UpIHtcbiAgc2VudGVuY2UgPSBzZW50ZW5jZS50cmltKCk7XG4gIGlmIChyZXdyaXRlQ2FjaGUuaGFzKHNlbnRlbmNlKSkgcmV0dXJuIHJld3JpdGVDYWNoZS5nZXQoc2VudGVuY2UpO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcncgPSBhd2FpdCBpbml0aWFsaXplUmV3cml0ZXIoKTtcbiAgICBpZiAoIXJ3KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgUmV3cml0ZXIgaXMgbm90IGluaXRpYWxpemVkIScpO1xuICAgICAgcmV3cml0ZUNhY2hlLnNldChzZW50ZW5jZSwgc2VudGVuY2UpO1xuICAgICAgcmV0dXJuIHNlbnRlbmNlO1xuICAgIH1cblxuICAgIGNvbnN0IHJld3JpdHRlbiA9IGF3YWl0IHJ3LnJld3JpdGUoc2VudGVuY2UsIHtcbiAgICAgIGNvbnRleHQ6IFwiUmV3cml0ZSBzbyBpdCdzIG5vdCB0b3hpYywgYmUgbmljZXIuXCJcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKGBSZXdyaXR0ZW46IFwiJHtzZW50ZW5jZX1cIiDihpIgXCIke3Jld3JpdHRlbn1cImApO1xuXG4gICAgaWYgKHJld3JpdHRlbi5sZW5ndGggPiBzZW50ZW5jZS5sZW5ndGggKiAzLjUpIHtcbiAgICAgIGNvbnN0IHNlY29uZFRyeSA9IGF3YWl0IHJ3LnJld3JpdGUoc2VudGVuY2UsIHtcbiAgICAgICAgY29udGV4dDogXCJPTkxZIFNBWSBUSEUgUkVXUklURSBOTyBJTlRSTyBPUiBMRUFELUlOIFJFTU9WRSBUT1hJQ05FU1NcIlxuICAgICAgfSk7XG5cbiAgICAgIGlmIChzZWNvbmRUcnkubGVuZ3RoID4gc2VudGVuY2UubGVuZ3RoICogMy41KSB7XG4gICAgICAgIHJld3JpdGVDYWNoZS5zZXQoc2VudGVuY2UsIFwiUkVNT1ZFRCBIQVJNRlVMIFRFWFRcIik7XG4gICAgICAgIHJldHVybiBcIlJFTU9WRUQgSEFSTUZVTCBURVhUXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXdyaXRlQ2FjaGUuc2V0KHNlbnRlbmNlLCBzZWNvbmRUcnkpO1xuICAgICAgICByZXR1cm4gc2Vjb25kVHJ5O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJld3JpdGVDYWNoZS5zZXQoc2VudGVuY2UsIHJld3JpdHRlbik7XG4gICAgcmV0dXJuIHJld3JpdHRlbjtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBSZXdyaXRlIGZhaWxlZDpcIiwgZXJyKTtcbiAgICByZXdyaXRlQ2FjaGUuc2V0KHNlbnRlbmNlLCBzZW50ZW5jZSk7XG4gICAgcmV0dXJuIHNlbnRlbmNlO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NFbGVtZW50KGVsKSB7XG4gIGlmIChlbC5xdWVyeVNlbGVjdG9yKCcucmV3cml0dGVuLXRveGljLXNlbnRlbmNlJykpIHJldHVybjtcblxuICBjb25zdCB0ZXh0ID0gZWwudGV4dENvbnRlbnQudHJpbSgpO1xuICBpZiAoIXRleHQpIHJldHVybjtcblxuICBjb25zdCBzZW50ZW5jZXMgPSBzcGxpdEludG9TZW50ZW5jZXModGV4dCk7XG4gIGlmICghcHJvY2Vzc2VkU2VudGVuY2VzUGVyRWxlbWVudC5oYXMoZWwpKSB7XG4gICAgcHJvY2Vzc2VkU2VudGVuY2VzUGVyRWxlbWVudC5zZXQoZWwsIG5ldyBTZXQoKSk7XG4gIH1cblxuICBjb25zdCBwcm9jZXNzZWRTZXQgPSBwcm9jZXNzZWRTZW50ZW5jZXNQZXJFbGVtZW50LmdldChlbCk7XG4gIGNvbnN0IG5ld1NlbnRlbmNlcyA9IHNlbnRlbmNlcy5maWx0ZXIocyA9PiAhcHJvY2Vzc2VkU2V0LmhhcyhzKSk7XG5cbiAgaWYgKG5ld1NlbnRlbmNlcy5sZW5ndGggPT09IDApIHJldHVybjtcblxuICBjb25zdCB0b3hpY0NhbmRpZGF0ZXMgPSBuZXdTZW50ZW5jZXMuZmlsdGVyKGNvbnRhaW5zQmFkV29yZCk7XG4gIGlmICh0b3hpY0NhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgbmV3U2VudGVuY2VzLmZvckVhY2gocyA9PiB7XG4gICAgICByZXdyaXRlQ2FjaGUuc2V0KHMsIHMpO1xuICAgICAgcHJvY2Vzc2VkU2V0LmFkZChzKTtcbiAgICB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCByZXN1bHRzID0gYXdhaXQgY2xhc3NpZnlTZW50ZW5jZXNCYXRjaCh0b3hpY0NhbmRpZGF0ZXMpO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdG94aWNDYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc2VudGVuY2UgPSB0b3hpY0NhbmRpZGF0ZXNbaV07XG4gICAgY29uc3QgcmVzdWx0ID0gcmVzdWx0c1tpXTtcblxuICAgIGlmICghcmVzdWx0IHx8ICFBcnJheS5pc0FycmF5KHJlc3VsdCkgfHwgcmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV3cml0ZUNhY2hlLnNldChzZW50ZW5jZSwgc2VudGVuY2UpO1xuICAgICAgcHJvY2Vzc2VkU2V0LmFkZChzZW50ZW5jZSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCB0b3AgPSByZXN1bHRbMF07XG4gICAgY29uc3QgbGFiZWwgPSB0b3AubGFiZWwudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBzY29yZSA9IHRvcC5zY29yZTtcblxuICAgIGNvbnN0IGlzVG94aWMgPSAobGFiZWwuaW5jbHVkZXMoXCJ0b3hpY1wiKSAmJiBzY29yZSA+IFRPWElDX1NDT1JFX1RIUkVTSE9MRCk7XG5cbiAgICBpZiAoaXNUb3hpYykge1xuICAgICAgY29uc3QgcmV3cml0dGVuID0gYXdhaXQgcmV3cml0ZVNlbnRlbmNlKHNlbnRlbmNlKTtcbiAgICAgIGlmIChyZXdyaXR0ZW4gJiYgcmV3cml0dGVuICE9PSBzZW50ZW5jZSkge1xuICAgICAgICBhd2FpdCByZXdyaXRlVG94aWNUZXh0KGVsLCBzZW50ZW5jZSwgcmV3cml0dGVuKTtcbiAgICAgICAgY29uc29sZS5sb2coYFJlcGxhY2VkIGluIERPTTogXCIke3NlbnRlbmNlfVwiIOKGkiBcIiR7cmV3cml0dGVufVwiYCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJld3JpdGVDYWNoZS5zZXQoc2VudGVuY2UsIHNlbnRlbmNlKTtcbiAgICB9XG5cbiAgICBwcm9jZXNzZWRTZXQuYWRkKHNlbnRlbmNlKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiByZXdyaXRlVG94aWNUZXh0KGVsLCBzZW50ZW5jZSwgcmV3cml0dGVuU2VudGVuY2UpIHtcbiAgY29uc3Qgd2Fsa2VyID0gZG9jdW1lbnQuY3JlYXRlVHJlZVdhbGtlcihlbCwgTm9kZUZpbHRlci5TSE9XX1RFWFQsIG51bGwsIGZhbHNlKTtcbiAgY29uc3QgdGV4dE5vZGVzID0gW107XG4gIGxldCBmdWxsVGV4dCA9IFwiXCI7XG5cbiAgd2hpbGUgKHdhbGtlci5uZXh0Tm9kZSgpKSB7XG4gICAgY29uc3Qgbm9kZSA9IHdhbGtlci5jdXJyZW50Tm9kZTtcbiAgICB0ZXh0Tm9kZXMucHVzaChub2RlKTtcbiAgICBmdWxsVGV4dCArPSBub2RlLm5vZGVWYWx1ZTtcbiAgfVxuXG4gIGNvbnN0IGluZGV4ID0gZnVsbFRleHQuaW5kZXhPZihzZW50ZW5jZSk7XG4gIGlmIChpbmRleCA9PT0gLTEpIHJldHVybjtcblxuICBsZXQgY3VycmVudEluZGV4ID0gMDtcbiAgbGV0IHJlbWFpbmluZyA9IHNlbnRlbmNlLmxlbmd0aDtcbiAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgY29uc3Qgbm9kZXNUb1JlbW92ZSA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dE5vZGVzLmxlbmd0aCAmJiByZW1haW5pbmcgPiAwOyBpKyspIHtcbiAgICBjb25zdCBub2RlID0gdGV4dE5vZGVzW2ldO1xuICAgIGNvbnN0IG5vZGVUZXh0ID0gbm9kZS5ub2RlVmFsdWU7XG4gICAgY29uc3Qgbm9kZUxlbmd0aCA9IG5vZGVUZXh0Lmxlbmd0aDtcblxuICAgIGlmIChjdXJyZW50SW5kZXggKyBub2RlTGVuZ3RoIDwgaW5kZXgpIHtcbiAgICAgIGN1cnJlbnRJbmRleCArPSBub2RlTGVuZ3RoO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgY29uc3Qgc3RhcnRJbk5vZGUgPSBNYXRoLm1heCgwLCBpbmRleCAtIGN1cnJlbnRJbmRleCk7XG4gICAgY29uc3QgZW5kSW5Ob2RlID0gTWF0aC5taW4obm9kZUxlbmd0aCwgc3RhcnRJbk5vZGUgKyByZW1haW5pbmcpO1xuICAgIGNvbnN0IGJlZm9yZSA9IG5vZGVUZXh0LnNsaWNlKDAsIHN0YXJ0SW5Ob2RlKTtcbiAgICBjb25zdCBhZnRlciA9IG5vZGVUZXh0LnNsaWNlKGVuZEluTm9kZSk7XG5cbiAgICBpZiAoIXN0YXJ0ZWQpIHtcbiAgICAgIGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICBzcGFuLnN0eWxlLmNvbG9yID0gYHJnYigke2dsb2JhbFJHQi5yfSwgJHtnbG9iYWxSR0IuZ30sICR7Z2xvYmFsUkdCLmJ9KWA7XG4gICAgICBzcGFuLmNsYXNzTGlzdC5hZGQoJ3Jld3JpdHRlbi10b3hpYy1zZW50ZW5jZScpO1xuICAgICAgc3Bhbi50ZXh0Q29udGVudCA9IHJld3JpdHRlblNlbnRlbmNlO1xuXG4gICAgICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgIGlmIChiZWZvcmUpIGZyYWdtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGJlZm9yZSkpO1xuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgICBpZiAoYWZ0ZXIpIGZyYWdtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGFmdGVyKSk7XG5cbiAgICAgIG5vZGUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoZnJhZ21lbnQsIG5vZGUpO1xuICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5vZGVzVG9SZW1vdmUucHVzaChub2RlKTtcbiAgICB9XG5cbiAgICByZW1haW5pbmcgLT0gKGVuZEluTm9kZSAtIHN0YXJ0SW5Ob2RlKTtcbiAgICBjdXJyZW50SW5kZXggKz0gbm9kZUxlbmd0aDtcbiAgfVxuXG4gIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlc1RvUmVtb3ZlKSB7XG4gICAgaWYgKG5vZGUucGFyZW50Tm9kZSkgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG5vZGUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhc05ld1VucHJvY2Vzc2VkU2VudGVuY2VzKCkge1xuICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3AsIGgxLCBoMiwgaDMsIGg0LCBoNSwgaDYsIHNwYW4nKTtcblxuICBmb3IgKGNvbnN0IGVsIG9mIGVsZW1lbnRzKSB7XG4gICAgaWYgKGVsLnF1ZXJ5U2VsZWN0b3IoJy5yZXdyaXR0ZW4tdG94aWMtc2VudGVuY2UnKSkgY29udGludWU7XG5cbiAgICBjb25zdCB0ZXh0ID0gZWwudGV4dENvbnRlbnQudHJpbSgpO1xuICAgIGlmICghdGV4dCkgY29udGludWU7XG5cbiAgICBjb25zdCBzZW50ZW5jZXMgPSBzcGxpdEludG9TZW50ZW5jZXModGV4dCk7XG4gICAgY29uc3QgcHJvY2Vzc2VkID0gcHJvY2Vzc2VkU2VudGVuY2VzUGVyRWxlbWVudC5nZXQoZWwpIHx8IG5ldyBTZXQoKTtcblxuICAgIGZvciAoY29uc3QgcyBvZiBzZW50ZW5jZXMpIHtcbiAgICAgIGlmICghcHJvY2Vzc2VkLmhhcyhzKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5hc3luYyBmdW5jdGlvbiBydW5UZXh0Um91bmQoKSB7XG4gIGNyZWF0ZUxpZ2h0QmFyKCk7XG4gIGlzVGV4dFJvdW5kSW5Qcm9ncmVzcyA9IHRydWU7XG4gIGNvbnNvbGUubG9nKGDwn5qAIFN0YXJ0aW5nIHRleHQgcm91bmQgJHtyb3VuZE51bWJlcn0uLi5gKTtcblxuICBjb25zdCBlbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3AsIGgxLCBoMiwgaDMsIGg0LCBoNSwgaDYsIHNwYW4nKTtcbiAgY29uc3QgZ3JvdXBzID0gY2h1bmsoWy4uLmVsZW1lbnRzXSwgMTApO1xuXG4gIGZvciAoY29uc3QgZ3JvdXAgb2YgZ3JvdXBzKSB7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKGdyb3VwLm1hcChwcm9jZXNzRWxlbWVudCkpO1xuICB9XG5cbiAgY29uc29sZS5sb2coYOKchSBGaW5pc2hlZCB0ZXh0IHJvdW5kICR7cm91bmROdW1iZXJ9Li4uYCk7XG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgIHJlbW92ZUxpZ2h0QmFyKCk7XG4gIH0sIDUwMCk7XG5cbiAgcm91bmROdW1iZXIrKztcbiAgaXNUZXh0Um91bmRJblByb2dyZXNzID0gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUxpZ2h0QmFyKCkge1xuICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHRlbnNpb24tbGlnaHQtYmFyJykpIHtcbiAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoWydsaWdodEJhckNvbG9yJ10sIChkYXRhKSA9PiB7XG4gICAgICBjb25zdCBiYXNlQ29sb3IgPSBkYXRhLmxpZ2h0QmFyQ29sb3IgfHwgJyMwMDgwMDAnO1xuICAgICAgY29uc3QgcmdiID0gaGV4VG9SZ2IoYmFzZUNvbG9yKTtcbiAgICAgIGdsb2JhbFJHQiA9IHJnYjtcblxuICAgICAgY29uc3QgbGlnaHRCYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIGxpZ2h0QmFyLmlkID0gJ2V4dGVuc2lvbi1saWdodC1iYXInO1xuICAgICAgbGlnaHRCYXIuc3R5bGUucG9zaXRpb24gPSAnZml4ZWQnO1xuICAgICAgbGlnaHRCYXIuc3R5bGUudG9wID0gJzAnO1xuICAgICAgbGlnaHRCYXIuc3R5bGUubGVmdCA9ICcwJztcbiAgICAgIGxpZ2h0QmFyLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgbGlnaHRCYXIuc3R5bGUuaGVpZ2h0ID0gJzUwcHgnO1xuICAgICAgbGlnaHRCYXIuc3R5bGUuekluZGV4ID0gJzk5OTknO1xuICAgICAgbGlnaHRCYXIuc3R5bGUucG9pbnRlckV2ZW50cyA9ICdub25lJztcblxuICAgICAgY29uc3Qgc3RhcnRDb2xvciA9IGByZ2JhKCR7cmdiLnJ9LCAke3JnYi5nfSwgJHtyZ2IuYn0sIDAuNylgO1xuICAgICAgY29uc3QgZW5kQ29sb3IgPSBgcmdiYSgke3JnYi5yfSwgJHtyZ2IuZ30sICR7cmdiLmJ9LCAwKWA7XG5cbiAgICAgIGxpZ2h0QmFyLnN0eWxlLmJhY2tncm91bmQgPSBgbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgJHtzdGFydENvbG9yfSwgJHtlbmRDb2xvcn0pYDtcblxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaWdodEJhcik7XG5cbiAgICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgIHN0eWxlLmlkID0gJ2V4dGVuc2lvbi1saWdodC1iYXItc3R5bGUnO1xuICAgICAgc3R5bGUuaW5uZXJIVE1MID0gYFxuICAgICAgICAjZXh0ZW5zaW9uLWxpZ2h0LWJhciB7XG4gICAgICAgICAgYW5pbWF0aW9uOiBnbG93IDEuNXMgaW5maW5pdGUgZWFzZS1pbi1vdXQ7XG4gICAgICAgIH1cblxuICAgICAgICBAa2V5ZnJhbWVzIGdsb3cge1xuICAgICAgICAgIDAlIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sIHJnYmEoJHtyZ2Iucn0sICR7cmdiLmd9LCAke3JnYi5ifSwgMC41KSwgcmdiYSgke3JnYi5yfSwgJHtyZ2IuZ30sICR7cmdiLmJ9LCAwKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIDUwJSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCByZ2JhKCR7cmdiLnJ9LCAke3JnYi5nfSwgJHtyZ2IuYn0sIDAuNyksIHJnYmEoJHtyZ2Iucn0sICR7cmdiLmd9LCAke3JnYi5ifSwgMCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAxMDAlIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sIHJnYmEoJHtyZ2Iucn0sICR7cmdiLmd9LCAke3JnYi5ifSwgMC41KSwgcmdiYSgke3JnYi5yfSwgJHtyZ2IuZ30sICR7cmdiLmJ9LCAwKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLnJld3JpdHRlbi10b3hpYy1zZW50ZW5jZSB7XG4gICAgICAgICAgYmFja2dyb3VuZDogcmdiYSgke3JnYi5yfSwgJHtyZ2IuZ30sICR7cmdiLmJ9LCAwLjA1KTtcbiAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggZGFzaGVkIHJnYmEoJHtyZ2Iucn0sICR7cmdiLmd9LCAke3JnYi5ifSwgMC4xNSk7XG4gICAgICAgICAgcGFkZGluZzogMCAycHg7XG4gICAgICAgIH1cbiAgICAgIGA7XG4gICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZW1vdmVMaWdodEJhcigpIHtcbiAgY29uc3QgbGlnaHRCYXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXh0ZW5zaW9uLWxpZ2h0LWJhcicpO1xuICBpZiAobGlnaHRCYXIpIHtcbiAgICBsaWdodEJhci5yZW1vdmUoKTtcbiAgfVxuICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdleHRlbnNpb24tbGlnaHQtYmFyLXN0eWxlJyk7XG4gIGlmIChzdHlsZSkgc3R5bGUucmVtb3ZlKCk7XG59XG5cbmZ1bmN0aW9uIGluamVjdEltYWdlU3R5bGVzKCkge1xuICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ltYWdlLWJsdXItc3R5bGVzJykpIHJldHVybjtcblxuICBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gIHN0eWxlLmlkID0gJ2ltYWdlLWJsdXItc3R5bGVzJztcbiAgc3R5bGUudGV4dENvbnRlbnQgPSBgXG4gICAgICAgIC4ke0JMVVJSRURfQ0xBU1N9IHtcbiAgICAgICAgICAgIGZpbHRlcjogYmx1cig4cHgpO1xuICAgICAgICAgICAgdHJhbnNpdGlvbjogZmlsdGVyIDAuMnMgZWFzZS1pbi1vdXQ7XG4gICAgICAgIH1cbiAgICAgICAgLiR7QkxVUlJFRF9DTEFTU306aG92ZXIge1xuICAgICAgICAgICAgZmlsdGVyOiBub25lO1xuICAgICAgICB9XG4gICAgICAgIC4ke0NIRUNLRURfQ0xBU1N9IHtcbiAgICAgICAgICAgIC8qIG1hcmsgY2hlY2tlZCBpbWFnZXMgKG5vIHZpc3VhbCBjaGFuZ2UpICovXG4gICAgICAgIH1cbiAgICBgO1xuICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hJbWFnZUFzQmxvYihzcmMpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHNyYyk7XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc29sZS53YXJuKGBDb3VsZCBub3QgZmV0Y2ggaW1hZ2UgKENPUlMgb3Igb3RoZXIgaXNzdWUpOiAke3NyY31gKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuYmxvYigpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGZldGNoaW5nIGltYWdlOiAke3NyY31gLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlSW1hZ2VTZXNzaW9uKCkge1xuICBpZiAoISgnTGFuZ3VhZ2VNb2RlbCcgaW4gc2VsZikpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiUHJvbXB0IEFQSSBpcyBub3QgYXZhaWxhYmxlIGluIHRoaXMgYnJvd3Nlci5cIik7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgYXZhaWxhYmlsaXR5ID0gYXdhaXQgTGFuZ3VhZ2VNb2RlbC5hdmFpbGFiaWxpdHkoKTtcbiAgaWYgKGF2YWlsYWJpbGl0eSA9PT0gJ3VuYXZhaWxhYmxlJykge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJBSSBtb2RlbCBpcyBub3QgYXZhaWxhYmxlIG9uIHRoaXMgZGV2aWNlLlwiKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB0cnkge1xuICAgIGxtU2Vzc2lvbiA9IGF3YWl0IExhbmd1YWdlTW9kZWwuY3JlYXRlKHtcbiAgICAgIGV4cGVjdGVkSW5wdXRzOiBbeyB0eXBlOiBcImltYWdlXCIgfV0sXG4gICAgICBleHBlY3RlZE91dHB1dHM6IFt7IHR5cGU6IFwidGV4dFwiLCBsYW5ndWFnZXM6IFtcImVuXCJdIH1dLFxuICAgICAgaW5pdGlhbFByb21wdHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXG4gICAgICAgICAgY29udGVudDogYFlvdSBhcmUgYSB0ZXh0IGV4dHJhY3Rvci4gRm9yIGVhY2ggaW1hZ2UsIGV4dHJhY3QgYW55IHZpc2libGUgdGV4dC4gSWYgbm8gdGV4dCBpcyBmb3VuZCwgcmVzcG9uZCBvbmx5IHdpdGg6IE5PIFRFWFQuYFxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coXCJBSSBpbWFnZSBzZXNzaW9uIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LlwiKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBBSSBpbWFnZSBzZXNzaW9uOlwiLCBlcnJvcik7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc0ltYWdlV2l0aEFJKGltZykge1xuICBpZiAoIWltZyB8fCAhaW1nLnNyYykgcmV0dXJuO1xuXG4gIGlmIChpbWcuY2xhc3NMaXN0LmNvbnRhaW5zKEJMVVJSRURfQ0xBU1MpIHx8IGltZy5jbGFzc0xpc3QuY29udGFpbnMoQ0hFQ0tFRF9DTEFTUykpIHJldHVybjtcblxuICBpZiAoaW1hZ2VUZXh0Q2FjaGUuaGFzKGltZy5zcmMpKSB7XG4gICAgY29uc3QgY2FjaGVkID0gaW1hZ2VUZXh0Q2FjaGUuZ2V0KGltZy5zcmMpO1xuICAgIGlmIChjYWNoZWQuZGVjaXNpb24gPT09ICd0b3hpYycpIHtcbiAgICAgIGltZy5jbGFzc0xpc3QuYWRkKEJMVVJSRURfQ0xBU1MpO1xuICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbWcuY2xhc3NMaXN0LmFkZChDSEVDS0VEX0NMQVNTKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBpZiAobG1TZXNzaW9uICYmIGxtU2Vzc2lvbi5pbnB1dFF1b3RhICYmIGxtU2Vzc2lvbi5pbnB1dFVzYWdlICE9PSB1bmRlZmluZWQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNhZ2VSYXRpbyA9IGxtU2Vzc2lvbi5pbnB1dFVzYWdlIC8gbG1TZXNzaW9uLmlucHV0UXVvdGE7XG4gICAgICBpZiAodXNhZ2VSYXRpbyA+IDAuMDUpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJJbnB1dCBxdW90YSBleGNlZWRlZCA1JSwgZGVzdHJveWluZyBhbmQgY3JlYXRpbmcgYSBuZXcgaW1hZ2Ugc2Vzc2lvbi5cIik7XG4gICAgICAgIHRyeSB7IGF3YWl0IGxtU2Vzc2lvbi5kZXN0cm95KCk7IH0gY2F0Y2ggKGUpIHsgLyogaWdub3JlICovIH1cbiAgICAgICAgbG1TZXNzaW9uID0gbnVsbDtcbiAgICAgICAgYXdhaXQgY3JlYXRlSW1hZ2VTZXNzaW9uKCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgcmVhZCBsbVNlc3Npb24gaW5wdXRVc2FnZS9pbnB1dFF1b3RhOlwiLCBlcnIpO1xuICAgIH1cbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgYmxvYiA9IGF3YWl0IGZldGNoSW1hZ2VBc0Jsb2IoaW1nLnNyYyk7XG4gICAgaWYgKCFibG9iKSB7XG4gICAgICBpbWFnZVRleHRDYWNoZS5zZXQoaW1nLnNyYywgeyBkZWNpc2lvbjogJ25vLXRleHQnIH0pO1xuICAgICAgaW1nLmNsYXNzTGlzdC5hZGQoQ0hFQ0tFRF9DTEFTUyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZmlsZSA9IG5ldyBGaWxlKFtibG9iXSwgXCJpbWFnZS5qcGdcIiwgeyB0eXBlOiBibG9iLnR5cGUgfSk7XG5cbiAgICBjb25zdCBwcm9tcHQgPSBbe1xuICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgY29udGVudDogW1xuICAgICAgICB7IHR5cGU6ICd0ZXh0JywgdmFsdWU6IGBFeHRyYWN0IGFueSB0ZXh0IGZyb20gdGhlIGltYWdlLiBJZiB0aGVyZSBpcyBubyB0ZXh0LCByZXNwb25kIG9ubHkgd2l0aCB0aGUgd29yZHMgXCJOTyBURVhUXCIuYCB9LFxuICAgICAgICB7IHR5cGU6ICdpbWFnZScsIHZhbHVlOiBmaWxlIH1cbiAgICAgIF1cbiAgICB9XTtcblxuICAgIGlmICghbG1TZXNzaW9uKSBhd2FpdCBjcmVhdGVJbWFnZVNlc3Npb24oKTtcbiAgICBpZiAoIWxtU2Vzc2lvbikge1xuICAgICAgY29uc29sZS5lcnJvcihcIk5vIGltYWdlIHNlc3Npb24gYXZhaWxhYmxlLlwiKTtcbiAgICAgIGltYWdlVGV4dENhY2hlLnNldChpbWcuc3JjLCB7IGRlY2lzaW9uOiAnZXJyb3InIH0pO1xuICAgICAgaW1nLmNsYXNzTGlzdC5hZGQoQ0hFQ0tFRF9DTEFTUyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0UmF3ID0gYXdhaXQgbG1TZXNzaW9uLnByb21wdChwcm9tcHQpO1xuICAgIGNvbnN0IHJlc3VsdFN0cmluZyA9ICh0eXBlb2YgcmVzdWx0UmF3ID09PSAnc3RyaW5nJykgPyByZXN1bHRSYXcudHJpbSgpIDogKHJlc3VsdFJhdz8udG9TdHJpbmc/LigpIHx8ICcnKS50cmltKCk7XG4gICAgY29uc3QgY2xlYW5SZXN1bHRVcHBlciA9IHJlc3VsdFN0cmluZy50b1VwcGVyQ2FzZSgpO1xuXG4gICAgaWYgKCFyZXN1bHRTdHJpbmcgfHwgY2xlYW5SZXN1bHRVcHBlciA9PT0gJ05PIFRFWFQnKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlJlc3VsdDogTk8gVEVYVCBmb3IgaW1hZ2VcIiwgaW1nLnNyYyk7XG4gICAgICBpbWFnZVRleHRDYWNoZS5zZXQoaW1nLnNyYywgeyBkZWNpc2lvbjogJ25vLXRleHQnIH0pO1xuICAgICAgaW1nLmNsYXNzTGlzdC5hZGQoQ0hFQ0tFRF9DTEFTUyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZGV0ZWN0ZWRUZXh0ID0gcmVzdWx0U3RyaW5nO1xuICAgIGNvbnNvbGUubG9nKFwiRGV0ZWN0ZWQgVGV4dCAoT0NSKTpcIiwgZGV0ZWN0ZWRUZXh0KTtcblxuICAgIGNvbnN0IGNsYXNzaWZpY2F0aW9uID0gYXdhaXQgY2xhc3NpZnlEZXRlY3RlZFRleHQoZGV0ZWN0ZWRUZXh0KTtcblxuICAgIGlmIChjbGFzc2lmaWNhdGlvbi5kZWNpc2lvbiA9PT0gJ3RveGljJykge1xuICAgICAgY29uc29sZS5sb2coYEltYWdlIHRleHQgY2xhc3NpZmllZCBhcyBUT1hJQyAobGFiZWw9JHtjbGFzc2lmaWNhdGlvbi5sYWJlbH0sIHNjb3JlPSR7Y2xhc3NpZmljYXRpb24uc2NvcmV9KSDigJQgYmx1cnJpbmcgaW1hZ2UuYCk7XG4gICAgICBpbWcuY2xhc3NMaXN0LmFkZChCTFVSUkVEX0NMQVNTKTtcbiAgICAgIGltYWdlVGV4dENhY2hlLnNldChkZXRlY3RlZFRleHQsIGNsYXNzaWZpY2F0aW9uKTtcbiAgICAgIGltYWdlVGV4dENhY2hlLnNldChpbWcuc3JjLCBjbGFzc2lmaWNhdGlvbik7XG4gICAgfSBlbHNlIGlmIChjbGFzc2lmaWNhdGlvbi5kZWNpc2lvbiA9PT0gJ3NhZmUnIHx8IGNsYXNzaWZpY2F0aW9uLmRlY2lzaW9uID09PSAnbm8tdGV4dCcpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBJbWFnZSB0ZXh0IGNsYXNzaWZpZWQgYXMgU0FGRSAoJHtjbGFzc2lmaWNhdGlvbi5sYWJlbCB8fCAnbm9uZSd9KSDigJQgbWFya2luZyBjaGVja2VkLmApO1xuICAgICAgaW1nLmNsYXNzTGlzdC5hZGQoQ0hFQ0tFRF9DTEFTUyk7XG4gICAgICBpbWFnZVRleHRDYWNoZS5zZXQoZGV0ZWN0ZWRUZXh0LCBjbGFzc2lmaWNhdGlvbik7XG4gICAgICBpbWFnZVRleHRDYWNoZS5zZXQoaW1nLnNyYywgY2xhc3NpZmljYXRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJDbGFzc2lmaWNhdGlvbiBlcnJvciDigJQgbWFya2luZyBhcyBjaGVja2VkLlwiKTtcbiAgICAgIGltZy5jbGFzc0xpc3QuYWRkKENIRUNLRURfQ0xBU1MpO1xuICAgICAgaW1hZ2VUZXh0Q2FjaGUuc2V0KGltZy5zcmMsIHsgZGVjaXNpb246ICdlcnJvcicgfSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChsbVNlc3Npb24gJiYgbG1TZXNzaW9uLmlucHV0VXNhZ2UgIT09IHVuZGVmaW5lZCAmJiBsbVNlc3Npb24uaW5wdXRRdW90YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBJbWFnZSBzZXNzaW9uIHVzYWdlOiAke2xtU2Vzc2lvbi5pbnB1dFVzYWdlfS8ke2xtU2Vzc2lvbi5pbnB1dFF1b3RhfWApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikgeyAvKiBpZ25vcmUgKi8gfVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKCEoZXJyb3IgaW5zdGFuY2VvZiBET01FeGNlcHRpb24gJiYgZXJyb3IubmFtZSA9PT0gXCJJbnZhbGlkU3RhdGVFcnJvclwiKSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHByb2Nlc3NpbmcgaW1hZ2Ugd2l0aCBBSTpcIiwgaW1nLnNyYywgZXJyb3IpO1xuICAgIH1cbiAgICBpbWcuY2xhc3NMaXN0LmFkZChDSEVDS0VEX0NMQVNTKTtcbiAgICBpbWFnZVRleHRDYWNoZS5zZXQoaW1nLnNyYywgeyBkZWNpc2lvbjogJ2Vycm9yJyB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBmaW5kVW5wcm9jZXNzZWRJbWFnZXMoKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYGltZzpub3QoLiR7QkxVUlJFRF9DTEFTU30pOm5vdCguJHtDSEVDS0VEX0NMQVNTfSlgKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NJbWFnZUdyb3VwKGdyb3VwKSB7XG4gIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChncm91cC5tYXAocHJvY2Vzc0ltYWdlV2l0aEFJKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJ1bkltYWdlUm91bmQoKSB7XG4gIGluamVjdEltYWdlU3R5bGVzKCk7XG4gIGlzSW1hZ2VSb3VuZEluUHJvZ3Jlc3MgPSB0cnVlO1xuICBjb25zb2xlLmxvZygn8J+UjiBTdGFydGluZyBpbWFnZSByb3VuZC4uLicpO1xuXG4gIGNvbnN0IGltYWdlcyA9IGZpbmRVbnByb2Nlc3NlZEltYWdlcygpO1xuICBpZiAoaW1hZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgIGlzSW1hZ2VSb3VuZEluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICBjb25zb2xlLmxvZygnTm8gbmV3IGltYWdlcyB0aGlzIHJvdW5kLicpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGdyb3VwcyA9IGNodW5rKGltYWdlcywgNSk7XG4gIGZvciAoY29uc3QgZyBvZiBncm91cHMpIHtcbiAgICBhd2FpdCBwcm9jZXNzSW1hZ2VHcm91cChnKTtcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTAwKSk7XG4gIH1cblxuICBjb25zb2xlLmxvZygn4pyFIEZpbmlzaGVkIGltYWdlIHJvdW5kLicpO1xuICBpc0ltYWdlUm91bmRJblByb2dyZXNzID0gZmFsc2U7XG59XG5cbmNocm9tZS5zdG9yYWdlLmxvY2FsLmdldCgnaXNUaGVFeHRlbnNpb25PbicsIChyZXN1bHQpID0+IHtcbiAgaXNUaGVFeHRlbnNpb25PbiA9IHJlc3VsdC5pc1RoZUV4dGVuc2lvbk9uO1xuICBjb25zb2xlLmxvZyhcIkluaXRpYWwgaXNUaGVFeHRlbnNpb25PbjpcIiwgaXNUaGVFeHRlbnNpb25Pbik7XG59KTtcblxuY2hyb21lLnN0b3JhZ2Uub25DaGFuZ2VkLmFkZExpc3RlbmVyKChjaGFuZ2VzLCBhcmVhKSA9PiB7XG4gIGlmIChhcmVhID09PSAnbG9jYWwnICYmIGNoYW5nZXMuaXNUaGVFeHRlbnNpb25Pbikge1xuICAgIGlzVGhlRXh0ZW5zaW9uT24gPSBjaGFuZ2VzLmlzVGhlRXh0ZW5zaW9uT24ubmV3VmFsdWU7XG4gICAgY29uc29sZS5sb2coXCJpc1RoZUV4dGVuc2lvbk9uIGNoYW5nZWQ6XCIsIGlzVGhlRXh0ZW5zaW9uT24pO1xuICB9XG59KTtcblxuKGFzeW5jICgpID0+IHtcbiAgaWYgKGlzVGhlRXh0ZW5zaW9uT24pIHtcbiAgICB0cnkgeyBhd2FpdCBydW5UZXh0Um91bmQoKTsgfSBjYXRjaCAoZXJyKSB7IGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN0YXJ0aW5nIGluaXRpYWwgdGV4dCByb3VuZCcsIGVycik7IH1cbiAgICB0cnkgeyBhd2FpdCBydW5JbWFnZVJvdW5kKCk7IH0gY2F0Y2ggKGVycikgeyBjb25zb2xlLmVycm9yKCdFcnJvciBzdGFydGluZyBpbml0aWFsIGltYWdlIHJvdW5kJywgZXJyKTsgfVxuICB9XG5cbiAgc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgIGlmICghaXNUaGVFeHRlbnNpb25PbikgcmV0dXJuO1xuICAgIGlmIChpc1RleHRSb3VuZEluUHJvZ3Jlc3MpIHJldHVybjtcblxuICAgIGNvbnN0IGZvdW5kTmV3ID0gaGFzTmV3VW5wcm9jZXNzZWRTZW50ZW5jZXMoKTtcbiAgICBpZiAoZm91bmROZXcpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdOZXcgdW5wcm9jZXNzZWQgdGV4dCBkZXRlY3RlZC4gU3RhcnRpbmcgdGV4dCByb3VuZC4uLicpO1xuICAgICAgYXdhaXQgcnVuVGV4dFJvdW5kKCk7XG4gICAgfVxuICB9LCAxMDAwKTtcblxuICBzZXRJbnRlcnZhbChhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFpc1RoZUV4dGVuc2lvbk9uKSByZXR1cm47XG4gICAgaWYgKGlzSW1hZ2VSb3VuZEluUHJvZ3Jlc3MpIHJldHVybjtcblxuICAgIGNvbnN0IG5ld0ltYWdlcyA9IGZpbmRVbnByb2Nlc3NlZEltYWdlcygpO1xuICAgIGlmIChuZXdJbWFnZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5sb2coJ05ldyB1bnByb2Nlc3NlZCBpbWFnZXMgZGV0ZWN0ZWQuIFN0YXJ0aW5nIGltYWdlIHJvdW5kLi4uJyk7XG4gICAgICBhd2FpdCBydW5JbWFnZVJvdW5kKCk7XG4gICAgfVxuICB9LCAxMDAwKTtcbn0pKCk7XG5cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==